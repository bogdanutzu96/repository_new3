2.0
33
0
NULL_REF
FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI
Freja STD3 to PEPPOL BIS Billing 3.0 for Finland
0
2
FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI.vw1
FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI.vw2
0
0
46
8228
0
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$VATMode

0
0
1
0

8228
1
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Empty

0
0
1
0

8228
2
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$SumGross

0
0
3
0

8228
3
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$R_SUMVAT_COUNTER

0
0
2
0

8228
4
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$SumVAT

0
0
3
0

8228
5
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$TARCount

0
0
2
0

8228
6
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$tmp

0
0
1
0

8228
7
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Row_no

0
0
2
0

8228
8
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$BuyerReference_mapped

0
0
1
0

8228
9
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$routing_code

0
0
1
0

8228
10
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$return_date

0
0
1
0

8228
11
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$decimals

0
0
1
0

8228
12
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$departure_date

0
0
1
0

8228
13
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Employee_Number

0
0
1
0

8228
14
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$note

0
0
1
0

8228
15
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$note2

0
0
1
0

8228
16
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$org_no

0
0
1
0

8228
17
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote

0
0
1
1

8228
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Establishment_nr

0
0
1
1

8228
19
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote_tmp

0
0
1
0

8228
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Establishment_tmp

0
0
1
0

8228
21
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Attachment_id_cnt

0
0
2
0

8228
22
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote_cnt

0
0
2
0

8228
23
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote_out

0
0
1
1

8228
25
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$base64encodedPDF

0
0
1
1

8228
24
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Sum_VAT_calculated

0
0
3
0

8228
26
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$endpoint

0
0
1
0

8228
27
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$AdjInvType

0
0
1
0

8228
28
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$ADDCount

0
0
2
0

8228
29
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$CreateInvoicePDF

0
0
1
0

8228
30
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$FindDeliveryNotePDF

0
0
1
0

8228
31
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$InvoiceCountry

0
0
1
0

8228
32
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Sum_NET

0
0
3
0

8228
34
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Sum_GROSS

0
0
3
0

8228
35
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Article_3050_exist

0
0
2
0

8228
36
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$InvoiceLanguageDebug

0
0
1
0

8228
37
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$InvoiceLanguage

0
0
1
0

8228
38
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Total_calc_amount

0
0
3
0

8228
39
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Total_amount

0
0
3
0

8228
40
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$CreateVAT

0
0
2
0

8228
41
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$CreateGross

0
0
2
0

8228
33
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$IBAN

0
0
1
0

4132
0
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
urn:cen.eu:en16931:2017#compliant#urn:fdc:peppol.eu:2017:poacc:billing:3.0
0
0

4132
1
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
urn:fdc:peppol.eu:2017:poacc:billing:01:1.0
0
0

4132
2
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
380
0
0

4132
3
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
UTF-8
0
0

541
37
1
NULL_REF
SL

0
0
0
0
0

1
#AD
364
DECLARE $TAC[] 	RECORD SEBTAC.TAC;
DECLARE $i 		INTEGER;
DECLARE $ConfArr [][] STRING;
DECLARE $VATList[] FLOAT;
DECLARE $R_SUMVAT[][]  FLOAT;
DECLARE $IsInList	INTEGER;
DECLARE $vaHits		INTEGER;
DECLARE $VATReason STRING;
DECLARE $empty_s_1[] CONSTANT STRING;
DECLARE $pdf_ix INTEGER;
DECLARE $base64encodedPDF_tmp STRING;
DECLARE $base64encodedPDF[] STRING;
DECLARE $Stop INTEGER;
DECLARE $GenericAttr RECORD SEBKORT_ATTRIBUTES.GenericRecord;

$Empty = "";
$DelNote = $empty_s_1;
$Establishment_nr = $empty_s_1;
$DelNote_out = $empty_s_1;
$base64encodedPDF_tmp= "";
$base64encodedPDF = $empty_s_1;
$pdf_ix = 0;
$FindDeliveryNotePDF = "";
$CreateInvoicePDF = "";
$InvoiceCountry = "";
$Sum_VAT_calculated = 0;
$Sum_NET = 0;
$Sum_GROSS = 0;
$Article_3050_exist = $false;
$CreateVAT = 1;
$CreateGross = 1;


# Get the generic attribute and see if invoice- and/or delivery note PDF should be handeled
TRY { 
	 NOLOG {
      $AttributeValue = MBC_HIERCHMSGENV.GetAttribute($SessionId, $MessageId, SEBKORT_ATTRIBUTES.$Generic); 
      UNSERIALIZE $AttributeValue INTO $GenericAttr;
   }
} 
CATCH $Exception 
WHEN OTHERS {}

IF ARRAYSIZE($GenericAttr.$Ref) > 0 {
   FOR $i = 1 TO ARRAYSIZE($GenericAttr.$ref) {
      IF $GenericAttr.$ref[$i] = "CreateInvoicePDF" {
         $CreateInvoicePDF = $GenericAttr.$value[$i];
      }
      ELSE IF $GenericAttr.$ref[$i] = "FindDeliveryNotePDF" {
         $FindDeliveryNotePDF = $GenericAttr.$value[$i];
      }
   }
}
ELSE { 
         $CreateInvoicePDF = "0";
         $FindDeliveryNotePDF = "0";
}

IF DMSIM.Simulating() {
$SEBKort_PartnerAttribute.$Parameter6 = "BuyerReference¤#CustCostCtr#;InvoiceNote¤Avvikande moms (dvs ej 6%, 12% eller 25% moms) kan förekomma på resefakturor.+CRNL+Har du frågor om följesedeln, ring Lingmerths: 010-122 68 96+CRNL+Har du frågor om fakturan, ring TAC Support: 08-14 68 60.+CRNL+Resenärer (netto):+SUM|PassName|N;";
}

# First get the configuration parameters from Map Control String.
$ConfArr = ParamFun.ExplodeParStrToArr( $tmp, $SEBKort_PartnerAttribute.$Parameter6, ";", "¤" );

# Get VATMode
$tmp = ParamFun.GetParamValue( $ConfArr, "VATMode");

IF $tmp = "" { 
	$VATMode = "NORMAL";
} ELSE {
	$VATMode = $tmp;
}


# Then read the potential TAC data for dynamic mapping.
$TAC = SEBTAC.GetSTD3TACData( $SessionId, $MessageId );

# Loop through all lines and make VAT sums for each VAT %
FOR $i = 1 TO ARRAYSIZE( $TAC ) {
   $TAC[$i].$VAT_is_deviant = $False;

   # VAT summaries
   $SumVAT = $SumVAT + $TAC[$i].$VAT;
   $SumGross = $SumGross + $TAC[$i].$Gross;

   IF $VATMode = "EXACT1" {
      $TAC[$i].$VATPercent = TRIMLEFT(($TAC[$i].$VATInvCur / $TAC[$i].$Net)*100, "-"); 
	    $TAC[$i].$VATPercent = FORMAT("%.1f", $TAC[$i].$VATPercent);
   }

   IF $VATMode = "NORMALSPAN" {
		  # Kod för att hantera ett momsspann. / Special för Sverige...
      IF $TAC[$i].$VATPercent > 20 AND $TAC[$i].$VATPercent < 28 { 
         $TAC[$i].$VATPercent = 25  ; 
      }
      ELSE IF $TAC[$i].$VATPercent > 10 AND $TAC[$i].$VATPercent < 15 { 
         $TAC[$i].$VATPercent = 12  ; 
      }
      ELSE IF $TAC[$i].$VATPercent >  4 AND $TAC[$i].$VATPercent <  8 {
         $TAC[$i].$VATPercent = 6 ; 
      }
      ELSE IF $TAC[$i].$VATPercent  < 2 { 
         $TAC[$i].$VATPercent = 0  ; 
      }
   }
   IF $VATMode = "NORMALINT" {        #      We roundoff values to integers....
      IF $TAC[$i].$VATPercent > 24.5 AND $TAC[$i].$VATPercent < 25.5 {
         $TAC[$i].$VATPercent = 25  ; 
      }
      ELSE IF $TAC[$i].$VATPercent > 11.5 AND $TAC[$i].$VATPercent < 12.5 {
         $TAC[$i].$VATPercent = 12  ; 
      }
      ELSE IF $TAC[$i].$VATPercent >  5.5 AND $TAC[$i].$VATPercent <  6.5 {
         $TAC[$i].$VATPercent = 6 ; 
      }
      ELSE IF $TAC[$i].$VATPercent < 0.5 {
         $TAC[$i].$VATPercent = 0  ; 
      }
   }   
   IF $VATMode = "NORMAL" OR $VATMode = "NORMALSPAN" OR $VATMode = "NORMALINT" { 
      $TAC[$i].$VATPercent = FORMAT("%.1f", $TAC[$i].$VATPercent); 
   }
   
   IF $VATMode = "GROSS" {
      $TAC[$i].$VAT = 0;
      $TAC[$i].$VATPercent = 0;
      $TAC[$i].$Net = $TAC[$i].$Gross;
      $TAC[$i].$VAT_is_deviant = $True;
   }
   
   IF $CreateInvoicePDF = "2" {
      # Don't adjust any VAT rates for PDF only invoices
   }
   ELSE {
      # Check if VAT is correct or not. If incorrect, sum the current line with 0 VAT and gross as line amount and replace input net with gross
         IF $TAC[$i].$VATPercent = 25.5 OR $TAC[$i].$VATPercent = 24 OR $TAC[$i].$VATPercent = 14 OR $TAC[$i].$VATPercent = 10 OR $TAC[$i].$VATPercent = 0 {
         # VAT is accurate, rounding amount will fix any calculation errors.
      }
      ELSE {
         IF $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100) <> $TAC[$i].$VAT OR $VATMode = "GROSS"{
            $TAC[$i].$VAT = 0;
            $TAC[$i].$VATPercent = 0;
            $TAC[$i].$Net = $TAC[$i].$Gross;
            $TAC[$i].$VAT_is_deviant = $True;
         }
         ELSE {
            # Do nothing, array is already correct
         }
      }
   }
   $IsInList = 0;
   $vaHits = 1;

   IF ARRAYSIZE($VATList) = 0 {

	    $VATList[1]         = $TAC[$i].$VATPercent ;
	    $R_SUMVAT[1][1]     = $TAC[$i].$VATPercent ;
	    $R_SUMVAT[1][2]     = $TAC[$i].$Net ;
	    $R_SUMVAT[1][3]     = $TAC[$i].$VAT ;
	    $R_SUMVAT[1][4]     = $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100);
   } 
   ELSE {
	    $IsInList = DMU.ListFind($TAC[$i].$VATPercent, $VATList) ;

	    IF $IsInList {
		     $R_SUMVAT[$IsInList][2]   = $R_SUMVAT[$IsInList][2] + $TAC[$i].$Net ;
		     $R_SUMVAT[$IsInList][3]   = $R_SUMVAT[$IsInList][3] + $TAC[$i].$VAT ;
		     $R_SUMVAT[$IsInList][4]   = $R_SUMVAT[$IsInList][4] + $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100);
	    }
	    ELSE {
		     FOR $l = 1 TO ARRAYSIZE($VATList) {
			      IF $VATList[$vaHits] < $TAC[$i].$VATPercent {
				       $vaHits = $vaHits + 1 ;
            }
         }
                    
         ARRAY INSERT $VATList FROM $vaHits ;
         $VATList[$vaHits]         = $TAC[$i].$VATPercent ;
         ARRAY INSERT $R_SUMVAT FROM $vaHits ;
         $R_SUMVAT[$vaHits][1]     = $TAC[$i].$VATPercent ;
         $R_SUMVAT[$vaHits][2]     = $TAC[$i].$Net;           # [plats i listan][datainnehåll]
         $R_SUMVAT[$vaHits][3]     = $TAC[$i].$VAT;
         $R_SUMVAT[$vaHits][4]     = $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100);
      }
   }
   IF $TAC[$i].$VATPercent < 0.2 AND $VATReason = "" {
      $VATReason = "Exempt from Tax" ;
   } 

   # Delivery note PDF preparations in case we have Attachment flag in the configuration string

   IF $FindDeliveryNotePDF = "1" {

      $Establishment_tmp = NYTTO.STRTOPOSIX(TRIMLEFT(TRIMRIGHT($TAC[$i].$EstNr)));
      $DelNote_tmp = $TAC[$i].$ExtInvRef;

      IF ARRAYSIZE($DelNote) = 0 {
         $DelNote[1] = $DelNote_tmp ;    
         $Establishment_nr[1] = $Establishment_tmp;
         $IsInList = $true;
      }
      ELSE {
         # Check if this delivery note number is already stated
         $IsInList = $false;
         FOR $p = 1 TO ARRAYSIZE($DelNote) {
            IF $DelNote_tmp = $DelNote[$p] {
               $IsInList = $true;
               BREAK;
            }
         }
      }

      IF NOT $IsInList {
         $DelNote[ARRAYSIZE($DelNote) + 1] = $DelNote_tmp ; 
         $Establishment_nr[ARRAYSIZE($Establishment_nr) + 1] = $Establishment_tmp;
      }
      ELSE {
         # Reference is already in list, do nothing
      }
   }
   # Check if article number 03050 exist on any of the invoice rows. Used for "AdditionalDocRef schemeId LEA" for Trafikverket
   IF TRIMLEFT($TAC[$i].$ArtNr, "0") = "3050" {
      $Article_3050_exist = $true;
   }
} # End FOR TAC

# Loop through all PDFs and save only the ones that have data
FOR $u = 1 TO ARRAYSIZE($DelNote) {
   $base64encodedPDF_tmp = SEBTAC.GetDeliveryNotePDF($DelNote[$u], $Establishment_nr[$u], "resebyraer.dat");
   IF STRLEN($base64encodedPDF_tmp) = 0 {
      $DelNote[$u] = TRIMLEFT($DelNote[$u], "0");
      $base64encodedPDF_tmp = SEBTAC.GetDeliveryNotePDF($DelNote[$u], $Establishment_nr[$u], "resebyraer.dat");
   }
   IF STRLEN($base64encodedPDF_tmp) > 0 {
      $pdf_ix = $pdf_ix +1;
      $base64encodedPDF[$pdf_ix] = $base64encodedPDF_tmp;
      $DelNote_out[$pdf_ix] = $DelNote[$u];
   }
}

# Log reference
$LogRef_InvoiceNr = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Number;

IF ParamFun.GetParamValue( $ConfArr, "RecipientNr") {
   IF STRLEN(ParamFun.GetParamValue( $ConfArr, "RecipientNr")) = 13 {
      $LogRef_GLN = ParamFun.GetParamValue( $ConfArr, "RecipientNr");
      $LogRef_OrgNr = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Organization_No;
   }
   ELSE {
      $LogRef_OrgNr = ParamFun.GetParamValue( $ConfArr, "RecipientNr");
   }
}

IF ParamFun.GetParamValue( $ConfArr, "BUYERPARTYTAXSCHEMECOMPANYID") {
   $LogRef_OrgNr = ParamFun.GetParamValue( $ConfArr, "BUYERPARTYTAXSCHEMECOMPANYID");
}
ELSE {
   $LogRef_OrgNr = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Organization_No;
}

$LogRef_CompanyName = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Name;

$LogRef_Tag1 = "IssueDate";
$LogRef_Value1 = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Date;

IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Sign_Mark_3 = "-" {
   $LogRef_Tag2 = "InvoiceType";
   $LogRef_Value2 = "Credit";
}
ELSE {
   $LogRef_Tag2 = "InvoiceType";
   $LogRef_Value2 = "Debit";
}

$LogRef_Tag3 = "Currency";
$LogRef_Value3 = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Currency_Code;

# Check if this Adjustment invoice type should be sent if ADA/ADD excist
IF $TAC[1].$OrigRecord = "ADA" {

   $AdjInvType = @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type;

   # Check if customer should receive RIA invoices. Default is ON
   IF SL_STRING.ToUpper(ParamFun.GetParamValue( $ConfArr, "SendADA")) = "OFF" {
      # Do not send ADA if no configuration for ADA
      $StopMessageReason = "ADA invoice should not be sent! Config string SendADA is set to OFF."; 
   } 

   # Add the ADA billing amount to Sum array
   $R_SUMVAT[1][1]     = "0" ;
   $R_SUMVAT[1][2]     =  @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Sign_Mark_3 & @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Billing_Amount;
   $R_SUMVAT[1][3]     = "0" ;
   $R_SUMVAT[1][4]     = "0";
}

# Sum up the diffrent amounts 
FOR $i = 1 TO ARRAYSIZE($R_SUMVAT) {
   $Sum_VAT_calculated = NYTTO.ROUNDOFF($Sum_VAT_calculated,2) + NYTTO.ROUNDOFF($R_SUMVAT[$i][4],2);
   $Sum_NET = $Sum_NET + $R_SUMVAT[$i][2];
   $Sum_GROSS = $Sum_VAT_calculated + $Sum_NET;
}

$Sum_VAT_calculated = NYTTO.ROUNDOFF($Sum_VAT_calculated, 2);
$Sum_NET = NYTTO.ROUNDOFF($Sum_NET, 2);
$Sum_GROSS = NYTTO.ROUNDOFF($Sum_GROSS, 2);

# Check if we have configuration for invocie country (affects the invoice layout)
IF STRLEN(ParamFun.GetParamValue( $ConfArr, "CustomerRegCountry")) > 0 {
   $InvoiceCountry = ParamFun.GetParamValue( $ConfArr, "CustomerRegCountry");
}
ELSE {
   IF TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country, " ") = "" {
      # If customer country is empty, use sending SEB country instead
      $InvoiceCountry = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Sender_Country)))));
   }
   ELSE {
      IF STRLEN(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country))) = 2 { # Assume correct country code from Freja
         $InvoiceCountry = TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country));
      }
      ELSE {
         $InvoiceCountry = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country)))));
      }
   }
}

# Get invoice language
IF NOT DMSIM.Simulating() {
   NOLOG {
      TRY {
         $InvoiceLanguage = MBC_HIERCHMSGENV.GetAttribute($SessionId, $MessageId, "InvoiceLanguage");
      }
      CATCH $exception
      WHEN OTHERS {
         $InvoiceLanguage = "EN";
      }
   }

   # If there's a string configuration it will override any attribute controlled language
   IF STRLEN(ParamFun.GetParamValue( $ConfArr, "InvoiceLanguage")) > 0 {
      $InvoiceLanguage = ParamFun.GetParamValue( $ConfArr, "InvoiceLanguage");
   }
} 
ELSE {
   $InvoiceLanguage = "EN";
}

/* Set hard to no until we've checked NCM for debug settings
IF $SEBKort_PartnerAttribute.$DEBUG = 1 {
   $InvoiceLanguageDebug = "Y";
} ELSE {
   $InvoiceLanguageDebug = "N";
}
*/
$InvoiceLanguageDebug = "N";

# Check if we will force creation of AdditionalItemProperty/Travel agency VAT and Gross amount. 
# AdditionalItemProperty/Travel agency VAT and Gross amount are used by PDF to fill data in columns, so we force creation 
# of these AdditionalItemProperties for the PDF to be ok.

IF $CreateInvoicePDF = "0" AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[ARRAYSIZE($TAC)])) = "OFF" {
   $CreateVAT = 0;
   $CreateGross = 0;
}
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0
0
37
1
NULL_REF
SL

0
0
0
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0
0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0
0
36
1
NULL_REF
DL

0
0


1
1
0
0
0
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Encoding:0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/CustomizationID:14
0
36
1
NULL_REF
DL

0
0


1
1
0
0
0
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/CustomizationID:14/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProfileID:15
0
36
1
NULL_REF
DL

0
0


1
1
0
0
0
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:1
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProfileID:15/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] ) & @@;
}
ELSE {
   $tmp = @@;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Number:8
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/IssueDate:19
0
36
1
NULL_REF
DL

0
0

DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Date:9
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/IssueDate:19/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DueDate:21
0
36
1
NULL_REF
DL

0
0

DMU.DateConvert(@Due_Date, "%Y%m%d", "%Y-%m-%d")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Due_Date:10
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DueDate:21/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceTypeCode:22
0
36
1
NULL_REF
DL

0
0


1
1
0
0
0
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:2
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceTypeCode:22/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$TAC[1].$OrigRecord <> "ADA"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23
0
36
1
NULL_REF
DL

0
0
$InvoiceCountry = "SE" OR (SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "InvoiceNote"), $TAC, $VATMode) <> "")
TRIMRIGHT($tmp, "\n")
1
0
0
13
$tmp = "";

IF $InvoiceCountry = "SE" {
   $tmp = "OBS! Ej underlag för momsredovisning.\n";
}

IF $VATMode = "GROSS" {
   $tmp = $tmp & " Net: " & TRIMLEFT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Net_Amount_Sign_Mark & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Net_Amount,"+") & " " & @Invoice_Currency_Code & ". VAT: " & TRIMLEFT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/MVA_Total_Amount_Sign_Mark & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/MVA_Total_Amount, "+") & " " & @Invoice_Currency_Code & ".\n"; 
}

IF SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "InvoiceNote"), $TAC, $VATMode) <> "" {
   $tmp = $tmp & SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "InvoiceNote"), $TAC, $VATMode);
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23/value:0
37
1
NULL_REF
SL

0
0
1
0
0
@/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "R" OR @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "E"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note_ADA:23
0
37
1
NULL_REF
SL

0
0
0
1
1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note_ADA:23
0
37
1
NULL_REF
SL

0
0
0
1
1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note_ADA:23
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = "";

IF @@ = "R" {
   $tmp = "Invoice Remainder. Remainder no: " & TRIMLEFT(@Reminder_Inv_Reminder_Level, "0") & ".";
}
ELSE IF @@ = "E" {
    $tmp = SEBTAC.GetTextTranslation("EVENT_INVOICE_TEXT", "FI", $InvoiceLanguageDebug); # This text should always be norweigan hence the "FI" hardcoding.
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Adjustment_Inv_Type:995
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note_ADA:23/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DocumentCurrencyCode:25
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Currency_Code:774
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DocumentCurrencyCode:25/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AccountingCost"), $TAC[ ARRAYSIZE($TAC)] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCost:31
0
36
1
NULL_REF
DL

0
0

SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AccountingCost"), $TAC[ARRAYSIZE($TAC)] )
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCost:31/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BuyerReference:33
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
18
$tmp = "";

$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "BuyerReference"), $TAC[ARRAYSIZE($TAC)] );

IF @../ADA_LOOP/ADA/Adjustment_Inv_Type = "I" OR @../ADA_LOOP/ADA/Adjustment_Inv_Type = "R" OR @../ADA_LOOP/ADA/Adjustment_Inv_Type = "E" OR @../ADA_LOOP/ADA/Adjustment_Inv_Type = "A"
{
	IF DMSIM.Simulating() {
 		$tmp=$tmp & "ADABuyerReference¤xxxx";
 		}
	ELSE {
		$tmp =  SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADABuyerReference"), $TAC[ARRAYSIZE($TAC)] );
		}
}


IF STRLEN($tmp) = 0 { 
	$tmp = "NA";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BuyerReference:33/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderReference"), $TAC[ ARRAYSIZE($TAC) ] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderReferencePrefix"), $TAC[ARRAYSIZE($TAC)] ) & SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderReference"), $TAC[ARRAYSIZE($TAC)] )
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
@/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Sign_Mark_3 = "-" AND STRLEN(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Original_Freja_Invoice_No, "0"), " ")) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC) ] ) & @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Original_Freja_Invoice_No;
}
ELSE {
   $tmp = @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Original_Freja_Invoice_No;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ ARRAYSIZE($TAC) ] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] )
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
0
0
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 AND SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADAContractDocumentReference"), $TAC[ ARRAYSIZE($TAC) ] ) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference_ADA:264
0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference_ADA:264/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference_ADA:264/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
# First check if ContractDocumentReference string is there and use it

$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] );

# Ovveride if ADAContractDocumentReference is present
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADAContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADAContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] );
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference_ADA:264/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$CreateInvoicePDF = "1"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$Attachment_id_cnt
1
0
0
1
$Attachment_id_cnt = $Attachment_id_cnt +1;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentDescription:54
0
36
1
NULL_REF
DL

0
0

"Commercial invoice"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentDescription:54/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56
0
36
1
NULL_REF
DL

0
0

"application/pdf"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/mimeCode:0
36
1
NULL_REF
DL

0
0

@Invoice_Number & ".pdf"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/filename:0
36
1
NULL_REF
DL

0
0

""
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/value:0
37
1
NULL_REF
SL

0
0
1
ARRAYSIZE($base64encodedPDF)
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$Attachment_id_cnt
1
0
0
2
$Attachment_id_cnt = $Attachment_id_cnt +1;
$DelNote_cnt = $DelNote_cnt +1;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/DocumentDescription:54
0
36
1
NULL_REF
DL

0
0

"Delivery note"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/DocumentDescription:54/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/Attachment:55
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56
0
36
1
NULL_REF
DL

0
0

"application/pdf"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/mimeCode:0
36
1
NULL_REF
DL

0
0

$DelNote_out[$DelNote_cnt] & ".pdf"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/filename:0
36
1
NULL_REF
DL

0
0

$base64encodedPDF[$DelNote_cnt]
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_DelNote:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalDocumentReference"), $TAC[ ARRAYSIZE($TAC)] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC[1])) > 0
$tmp
1
0
0
12
$tmp = "";

# Special handling of LEA concept for Trafikverket
IF $Article_3050_exist = $true AND SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC, $VATMode) = "LEA" {
   $tmp = "LEA";
}
ELSE IF $Article_3050_exist = $false AND SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC, $VATMode) = "LEA" {
   $tmp = "";
}
ELSE {
   $tmp = SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC, $VATMode);
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203/SEQUENCE1:0/ID:3/schemeID:0
36
1
NULL_REF
DL

0
0

SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocumentReference"), $TAC, $VATMode)
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues(  ParamFun.GetParamValue( $ConfArr, "AddDocRefDocTypeCode"), $TAC[ ARRAYSIZE($TAC)] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203/SEQUENCE1:0/DocumentTypeCode:47
0
36
1
NULL_REF
DL

0
0

 ParamFun.GetParamValue( $ConfArr, "AddDocRefDocTypeCode")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference_string:203/SEQUENCE1:0/DocumentTypeCode:47/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ProjNr"), $TAC[ ARRAYSIZE($TAC)] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = "";

IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ProjNr"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ProjNr"), $TAC[ ARRAYSIZE($TAC)] );
}
ELSE {
   $tmp = @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TRA/Project_No;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/AdditionalAccountID:284
0
36
1
NULL_REF
DL

0
0

"ZZZ"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/AdditionalAccountID:284/schemeID:0
36
1
NULL_REF
DL

0
0

"DC01"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/AdditionalAccountID:284/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
25
$tmp = SEBTAC.GetPEPPOLSchemeID(TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))), @@);

IF $tmp = "" {
   DMU.Stop "Unkown country. Unable to resolve code to AccountingSupplierParty/Party/Endpoint";
}

/*
IF STRLEN(@@) = 13 {
   $tmp = "0088"; # Code for GLN/EAN
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {
   $tmp = "0007";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {
   $tmp = "0192";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {
   $tmp = "0184";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {
   $tmp = "0037";
}
ELSE {
   DMU.Stop "Unkown country. Unable to resolve code to AccountingSupplierParty/Party/Endpoint";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/schemeID:0
36
1
NULL_REF
DL

0
0

SEBTAC.RemDash(@@)
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Name:219
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Address1:729
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_City:732
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Zip_Code:731
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
9
IF STRLEN(TRIMRIGHT(@@, " ")) > 1 {
	$tmp = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@@)))));
} ELSE {
	$tmp = @@;
}

IF $tmp = "ZZ" {
   $tmp = "NA";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Country:733
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
1 = 2
0
1
# TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) <> "NO"
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"SWT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0

$org_no
1
0
0
17
$org_no = "";

IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {
   $org_no = "SE" & @Sender_Organisation_No & "01";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {
   $org_no = "NO" & @Sender_Organisation_No & "MVA";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {
   $org_no = "FI" & NYTTO.CLEANDIGITONLY(@Sender_Organisation_No);
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {
   $org_no = @Sender_Organisation_No;
}
ELSE {
   $org_no = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@@))))) & @Sender_Organisation_No;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0

"Godkänd för F-skatt"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"TAX"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_TAX:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegName"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegName"), $TAC[ ARRAYSIZE($TAC) ] );
}
ELSE {
   $tmp = @@;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Name:219
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegCompID"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegCompID"), $TAC[ ARRAYSIZE($TAC) ] );
}
ELSE {
   $tmp = SEBTAC.RemDash(@@);
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$Contact_name
1
0
1
DECLARE $Contact_name STRING;
20
$Contact_name = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierContactName"), $TAC[ 1 ] );

IF $Contact_name = "" {
   IF TRIMRIGHT(@Customer_Country, " ") <> "" {
      IF STRLEN(TRIMRIGHT(@Customer_Country, " ")) > 2 {
         IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Customer_Country))))) = "NO" {
            $Contact_name = "Diners Club Norge  Corporate Support";
         }
         ELSE {
            $Contact_name = @@;
         }
      }
      ELSE {
         $Contact_name = @@;
      }
   }
   ELSE {
      $Contact_name = @@;
   }
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Name:219
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/ElectronicMail:148
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
33
$tmp ="";

$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SEBContactEmail"), $TAC[ 1 ] );

IF $tmp = "" {

   IF $InvoiceCountry = "SE" {
      $tmp = "tacsupport@dinersclub.se ";
   }
   ELSE IF $InvoiceCountry = "NO" {
      $tmp = "reisekonto@dinersclub.no";
   }
   ELSE IF $InvoiceCountry = "DK" {
      $tmp = "rejsekonto@dinersclub.dk";
   }
   ELSE IF $InvoiceCountry = "FI" {
      $tmp = "tacsupport@dinersclub.fi";
   }
   ELSE {
      IF @Invoice_Currency_Code = "SEK" {
         $tmp = "tacsupport@dinersclub.se ";
      }
      ELSE IF @Invoice_Currency_Code = "NOK" {
         $tmp = "reisekonto@dinersclub.no";
      }
      ELSE IF @Invoice_Currency_Code = "DKK" {
         $tmp = "rejsekonto@dinersclub.dk";
      }
      ELSE IF @Invoice_Currency_Code = "EUR" {
         $tmp = "tacsupport@dinersclub.fi";
      }
   }
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/ElectronicMail:148/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
54
$tmp = "";
$endpoint = "";

IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNr"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {
   $endpoint = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNr"), $TAC[ ARRAYSIZE($TAC)] );
}
ELSE {
   $endpoint = SEBTAC.RemDash(@@);
}

IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNrSchemeId"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {
   $tmp =SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNrSchemeId"), $TAC[ ARRAYSIZE($TAC)] );
}
ELSE {
   $tmp = SEBTAC.GetPEPPOLSchemeID($InvoiceCountry, $endpoint);
}

# If we didn't get a proper SchemeID, use the invoice issuing country as country in the lookup and assume domestic invocie
IF $tmp = "" {
   $tmp = SEBTAC.GetPEPPOLSchemeID(TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))), $endpoint);
}

/*
IF STRLEN($endpoint) = 13 {
   $tmp = "0088"; # Code for GLN/EAN
}
ELSE IF $InvoiceCountry = "SE" {
   $tmp = "0007";
}
ELSE IF $InvoiceCountry = "NO" {
   $tmp = "0192";
}
ELSE IF $InvoiceCountry = "DK" {
   $tmp = "0092";
}
ELSE IF $InvoiceCountry = "FI" {
   $tmp = "0037";
}
# Use the Diners coutry code for the customer if customer country is missing since the customer is most likely a domestic customer.
ELSE {
   IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {
      $tmp = "0007";
   }
   ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {
      $tmp = "0192";
   }
   ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {
      $tmp = "0092";
   }
   ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {
      $tmp = "0037";
   }
}
*/
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/schemeID:0
36
1
NULL_REF
DL

0
0

$endpoint
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = "";

IF TRIMLEFT(@Customer_Name, " ") > 0 {
   $tmp = @Customer_Name;
}
ELSE {
   $tmp = @Address_Line_1_Member_Name;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Address1:738
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_City:741
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Zip_Code:740
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106
0
36
1
NULL_REF
DL

0
0

$tmp
1
1
0
9
$tmp = "";

# If country is missing for the customer, we assume it's a native invoice and use the Diners country instead
IF TRIMRIGHT($InvoiceCountry, " ") = "ZZ" {
   $tmp = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country)))));
}
ELSE {
   $tmp = $InvoiceCountry;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Country:742
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) <> "NO" AND 1=2
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = "";

IF STRLEN($endpoint) = "13" {
   $tmp = SEBTAC.RemDash(@@);
}
ELSE {
   $tmp = $endpoint;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"SWT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_SWT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0

$org_no
1
0
0
80
$org_no = "";

IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerTaxCompanyId"), $TAC[1]) <> "" {
   $org_no = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerTaxCompanyId"), $TAC[1]);
}
ELSE {
   # If string length of endpoint (could be overridden by RecipientNr from string config) is 13, assume GLN and use org.nr
   IF STRLEN($endpoint) = "13" {
      IF $InvoiceCountry = "SE" {
         $org_no = "SE" & SEBTAC.RemDash(@@) & "01";
      }
      ELSE IF $InvoiceCountry = "NO" {
         $org_no = "NO" & SEBTAC.RemDash(@@) & "MVA";
      }
      ELSE IF $InvoiceCountry = "DK" {
         $tmp = SEBTAC.RemDash(@@);
         IF STRLEN($tmp) > 2 {
            IF $tmp[1,2] <> "DK" {
               $org_no = "DK" & SEBTAC.RemDash(@@);
            }
            ELSE {
               $org_no = SEBTAC.RemDash(@@);
            }
         }
      }
      # If country is missing on the customer, try to use the issuing companys country (assuming it's a domestic invoice)
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {
         $org_no = "SE" & SEBTAC.RemDash(@@) & "01";
      }
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {
         $org_no = "NO" & SEBTAC.RemDash(@@) & "MVA";
      }
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {
         $tmp = SEBTAC.RemDash(@@);
         IF STRLEN($tmp) > 2 {
            IF $tmp[1,2] <> "DK" {
               $org_no = "DK" & SEBTAC.RemDash(@@);
            }
            ELSE {
               $org_no = SEBTAC.RemDash(@@);
            }
         }
      }
      ELSE {
         $org_no = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Customer_Country))))) & SEBTAC.RemDash(@@);
      }
   }
   ELSE {
      IF $InvoiceCountry = "SE" {
         $org_no = "SE" & SEBTAC.RemDash($endpoint) & "01";
      }
      ELSE IF $InvoiceCountry = "NO" {
         $org_no = "NO" & SEBTAC.RemDash($endpoint) & "MVA";
      }
      ELSE IF $InvoiceCountry = "DK" {
         $tmp = SEBTAC.RemDash(@@);
         IF STRLEN($tmp) > 2 {
            IF $tmp[1,2] <> "DK" {
               $org_no = "DK" & SEBTAC.RemDash(@@);
            }
            ELSE {
               $org_no = SEBTAC.RemDash(@@);
            }
         }
      }
      # If country is missing on the customer, try to use the issuing companys country (assuming it's a domestic invoice)
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {
         $org_no = "SE" & SEBTAC.RemDash($endpoint) & "01";
      }
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {
         $org_no = "NO" & SEBTAC.RemDash($endpoint) & "MVA";
      }
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {
         $org_no = SEBTAC.RemDash($endpoint);
      }
      ELSE {
         $org_no = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Customer_Country))))) & SEBTAC.RemDash($endpoint);
      }
   }
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme_VAT:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = "";

IF TRIMLEFT(@Customer_Name, " ") > 0 {
   $tmp = @Customer_Name;
}
ELSE {
   $tmp = @Address_Line_1_Member_Name;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
26
$tmp = "";

IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerLegalCompanyId"), $TAC[1]) <> "" {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerLegalCompanyId"), $TAC[1]);
}
ELSE {
   IF STRLEN($endpoint) = "13" {
      IF $InvoiceCountry = "DK" {
         $tmp = SEBTAC.RemDash(@@);
         IF STRLEN($tmp) > 2 {
            IF $tmp[1,2] <> "DK" {
               $tmp = "DK" & SEBTAC.RemDash(@@);
            }
            ELSE {
               $tmp = SEBTAC.RemDash(@@);
            }
         }
      }
      ELSE {
         $tmp = SEBTAC.RemDash(@@);
      }
   }
   ELSE {
      $tmp = $endpoint;
   }
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

2
#removed STRLEN(ParamFun.GetParamValue( $ConfArr, "ContactName")) > 0
# /AD
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
15
$tmp = "";

$tmp = @Member_Id;

IF TRIMRIGHT($tmp, " ") = "" {
    $tmp = @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Member_Id;
}

IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContactName"), $TAC[1]) <> "" {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContactName"), $TAC[1]);
}

IF $tmp = "" {
   $tmp = "NA";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ActualDeliveryDate"), $TAC[ ARRAYSIZE($TAC)] )) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296/SEQUENCE1:0/ActualDeliveryDate:300
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF SL_STRING.ToUpper(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ActualDeliveryDate"), $TAC[ ARRAYSIZE($TAC)] )) = "INVOICEDATE" {
   $tmp = DMU.DateConvert(@INVOICE_DATE, "%Y%m%d", "%Y-%m-%d");
}
ELSE {
   $tmp = DMU.DateNow("%Y-%m-%d");
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296/SEQUENCE1:0/ActualDeliveryDate:300/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "PayeeFinancialAccount") <> "NOACCOUNT"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentMeansCode:232
0
36
1
NULL_REF
DL

0
0

"30"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Diners_Club_Bank_Account_No:415
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentMeansCode:232/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentID:237
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/OCR_Ref:752
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentID:237/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0
1=2
$tmp
1
0
0
28
$tmp ="";

IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {
   $tmp = "BG";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {
   $tmp = "BBAN";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {
   $tmp = "???";
}
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {
   $tmp = "???";
}
ELSE {
   IF @Invoice_Currency_Code = "SEK" {
      $tmp = "BG";
   }
   ELSE IF @Invoice_Currency_Code = "NOK" {
      $tmp = "BBAN";
   }
   ELSE IF @Invoice_Currency_Code = "DKK" {
      $tmp = "???";
   }
   ELSE IF @Invoice_Currency_Code = "EUR" {
      $tmp = "???";
   }
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3/schemeID:0
36
1
NULL_REF
DL

0
0

TrimLeft(@Diners_Club_Bank_Registration_No, "0") & TrimLeft(@@,"0")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Diners_Club_Bank_Account_No:415
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
18
$tmp = "";

# If we have oveerride, use that
IF STRLEN(ParamFun.GetParamValue( $ConfArr, "BIC")) > 0 {
   $tmp = ParamFun.GetParamValue( $ConfArr, "BIC");
}
ELSE {
   # If PayeeFinancialAccount configuration is made, use BIC from file
   IF STRLEN(ParamFun.GetParamValue( $ConfArr, "PayeeFinancialAccount")) > 0 {
      $tmp = @@;
   }
   ELSE IF @Invoice_Currency_Code = "SEK" {
      $tmp = "SE:BANKGIRO"; # Swedish bankgiro 
   }
   ELSE {
      $tmp = @@;
   }
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/SWIFT:990
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "IBAN") <> "NOIBAN"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PaymentMeansCode:232
0
36
1
NULL_REF
DL

0
0
STRLEN(TRIMLEFT($IBAN)) > 0
"30"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PaymentMeansCode:232/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PaymentID:237
0
36
1
NULL_REF
DL

0
0
STRLEN(TRIMLEFT($IBAN)) > 0

1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/OCR_Ref:752
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PaymentID:237/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0
STRLEN(TRIMLEFT($IBAN)) > 0
$IBAN
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/IBAN:938
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0
STRLEN(TRIMLEFT($IBAN)) > 0
"IBAN"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0
STRLEN(TRIMLEFT($IBAN)) > 0
$tmp
1
0
0
8
$tmp = "";

IF STRLEN(ParamFun.GetParamValue( $ConfArr, "IBANBIC")) > 0 {
   $tmp = ParamFun.GetParamValue( $ConfArr, "IBANBIC");
}
ELSE {
   $tmp = @SWIFT;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/SWIFT:990
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans_IBAN:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$TAC[1].$OrigRecord <> "ADA" AND STRLEN(ParamFun.GetParamValue( $ConfArr, "PaymentTerms")) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0/Note:23
0
36
1
NULL_REF
DL

0
0

ParamFun.GetParamValue( $ConfArr, "PaymentTerms")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0/Note:23/value:0
37
1
NULL_REF
SL

0
0
1
0
0
$TAC[1].$OrigRecord = "ADA"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms_ADA:744
0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms_ADA:744/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms_ADA:744/SEQUENCE1:0/Note:23
0
36
1
NULL_REF
DL

0
0

"Penalty Surcharge Percent: " & FORMAT("%.2f",(@@)/100) & "%" 
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Interest_Inv_Interest_Rate:996
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms_ADA:744/SEQUENCE1:0/Note:23/value:0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxAmount:223
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxAmount:223/currencyID:0
36
1
NULL_REF
DL

0
0

FORMAT("%.2f", $Sum_VAT_calculated)
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxAmount:223/value:0
37
1
NULL_REF
SL

0
0
1
ARRAYSIZE($R_SUMVAT)
-1

1
$R_SUMVAT_COUNTER = 0;
1
$R_SUMVAT_COUNTER = $R_SUMVAT_COUNTER + 1;
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxableAmount:228
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxableAmount:228/currencyID:0
36
1
NULL_REF
DL

0
0

FORMAT("%.2f", $tmp)
1
0
0
10
$tmp = "";

$tmp = $R_SUMVAT[$R_SUMVAT_COUNTER][2] ;

IF $tmp = 0 {
	$tmp = "0.00";
}
IF $tmp = "-0.00" {
	$tmp = "0.00";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxableAmount:228/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxAmount:223
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxAmount:223/currencyID:0
36
1
NULL_REF
DL

0
0

NYTTO.ROUNDOFF($R_SUMVAT[$R_SUMVAT_COUNTER][4], 2)
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxAmount:223/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
5
IF $R_SUMVAT[$R_SUMVAT_COUNTER][1] = 0 {
	$tmp = "E";
} ELSE {
	$tmp = "S";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/Percent:216
0
36
1
NULL_REF
DL

0
0

FORMAT("%.1f", $R_SUMVAT[$R_SUMVAT_COUNTER][1])
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/Percent:216/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$R_SUMVAT[$R_SUMVAT_COUNTER][1] = 0 AND $VATReason <> ""
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReasonCode:218
0
36
1
NULL_REF
DL

0
0
1=2
"Exempt from VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReasonCode:218/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$R_SUMVAT[$R_SUMVAT_COUNTER][1] = 0 AND $VATReason <> ""
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReason:219
0
36
1
NULL_REF
DL

0
0

$VATReason
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReason:219/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/LineExtensionAmount:703
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
36
1
NULL_REF
DL

0
0

NYTTO.ROUNDOFF($Sum_NET, 2)
1
1
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/LineExtensionAmount:703/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxExclusiveAmount:828
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxExclusiveAmount:828/currencyID:0
36
1
NULL_REF
DL

0
0

NYTTO.ROUNDOFF($Sum_NET, 2)
1
1
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxExclusiveAmount:828/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxInclusiveAmount:829
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxInclusiveAmount:829/currencyID:0
36
1
NULL_REF
DL

0
0

NYTTO.ROUNDOFF($tmp, 2)
1
1
0
1
$tmp = $Sum_VAT_calculated + $Sum_NET;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxInclusiveAmount:829/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableRoundingAmount:833
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Currency_Code:774
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableRoundingAmount:833/currencyID:0
36
1
NULL_REF
DL

0
0

FORMAT("%.2f", $tmp)
1
0
2
DECLARE $Total_amount FLOAT;
DECLARE $Total_calc_amount FLOAT;
5
$Total_amount = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Sign_Mark_3 & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Accumulated_Total_Detail;

$Total_calc_amount = $Sum_NET + $Sum_VAT_calculated;

$tmp = $Total_amount - $Total_calc_amount
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableRoundingAmount:833/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableAmount:834
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableAmount:834/currencyID:0
36
1
NULL_REF
DL

0
0

NYTTO.ROUNDOFF($tmp, 2)
1
1
0
12
IF @Sign_Mark_3 = "-" {
   $tmp = FORMAT("%.2f", (@Sign_Mark_3 & @Accumulated_Total_Detail));
} 
ELSE {
   $tmp = @Accumulated_Total_Detail;
}
IF $tmp = 0 {
   $tmp = "0.00";
}
ELSE IF $tmp = "-0.00" {
   $tmp = "0.00";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableAmount:834/value:0
37
1
NULL_REF
SL

0
0
0
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
37
1
NULL_REF
SL

0
0
1
0
0

0
3
$TARCount = $TARCount + 1;

$tmp = ParamFun.GetParamValue( $ConfArr, "CreateSingleLineInvoice");
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

 FORMAT("%.0f", $Row_no)
1
0
0
1
$Row_no = $Row_no + 1 ;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Note:23
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
23
DECLARE $trans_amt STRING;
DECLARE $tmp_d_1 STRING;
DECLARE $tmp_d_2 STRING;
DECLARE $Code1 STRING;
DECLARE $Code2 STRING;
DECLARE $Code3 STRING;
DECLARE $Code4 STRING;
DECLARE $Code5 STRING;

$Employee_Number = "";
$departure_date = "";
$return_date = "";
$routing_code = "";
$tmp = "";
$note = "";
$note2 = "";

#Nullstille felt for hver "runde":
$Code1 = "";
$Code2 = "";
$Code3 = "";
$Code4 = "";
$Code5 = "";
44
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "LineNote"), $TAC[  $TARCount ]);

IF $VATMode = "SFTI" {
  $tmp = SEBTAC.GetLeadText("SE", "ROWVATERR") & TRIMLEFT((@Sign_Mark_2 & @VAT_Amount), "+") & " " & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Currency_Code & "\r\n" & $tmp; 
	
}

# If not SFTI or LineNote from configuration string, set default value
IF $tmp = "" {
   $tmp = "Point of sale: " & @Establishment_Name & ", " & "Purchase: " & @Document_Description;
}

IF STRLEN(@Routing_Code_1) > 0 {
   $Code1 = @Routing_Code_1 & ";";
}
IF STRLEN(@Routing_Code_1) > 3 {
   $Code1 = STRMID(@Routing_Code_1, 1, 3) & ";";
}
IF STRLEN(@Routing_Code_2) > 0 {
   $Code2 = @Routing_Code_2 & ";";
}
IF STRLEN(@Routing_Code_2) > 3 {
   $Code2 = STRMID(@Routing_Code_2, 1, 3) & ";";
} 
IF STRLEN(@Routing_Code_3) > 0 {
   $Code3 = @Routing_Code_3 & ";";
}
IF STRLEN(@Routing_Code_3) > 3 {
   $Code3 = STRMID(@Routing_Code_3, 1, 3) & ";";
} 
IF STRLEN(@Routing_Code_4) > 0 {
   $Code4 = @Routing_Code_4 & ";";
}
IF STRLEN(@Routing_Code_4) > 3 {
   $Code4 = STRMID(@Routing_Code_4, 1, 3) & ";";
} 
IF STRLEN(@Routing_Code_5) > 0 {
   $Code5 = @Routing_Code_5 & ";";
}
IF STRLEN(@Routing_Code_5) > 3 {
   $Code5 = STRMID(@Routing_Code_5, 1, 3) & ";";
}

$routing_code = $Code1 & $Code2 & $Code3 & $Code4 & $Code5;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Note:23/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702
0
36
1
NULL_REF
DL

0
0

"EA"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/unitCode:0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
9
$tmp = "";

IF @Sign_Mark_3 = "-" {
	$tmp = "-1";
}

ELSE {
	$tmp = "1";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Invoice_Currency:842
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
36
1
NULL_REF
DL

0
0

FORMAT("%.2f", $tmp)
1
1
0
12
IF $VATMode = "SFTI" {
  $tmp = @Sign_Mark_3 & @Billing_Amount;
} 
ELSE IF $VATMode = "GROSS" {
   $tmp = FORMAT("%.2f", $TAC[$TARCount].$gross);
}
ELSE {
   $tmp = $TAC[$TARCount].$Net;
}
IF @@ = 0 {
	$tmp = "0.00";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Net_Amount:837
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/AccountingCost:31
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
5
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AccountingCostLine"), $TAC[  $TARCount ]);

IF $tmp = "" {
  $tmp = @Employee_No & "/" & @Customer_Cost_Centre & "/" & @Ordered_By & "/" & @Requisition_Order_No & "/" & @Project_No;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/AccountingCost:31/value:0
37
1
NULL_REF
SL

0
0
1
0
0
$CreateInvoicePDF = "1"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34/SEQUENCE1:0/StartDate:35
0
36
1
NULL_REF
DL

0
0

DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230/Transaction_Date:248
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34/SEQUENCE1:0/StartDate:35/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderLineReference"), $TAC[  $TARCount ])) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646/SEQUENCE1:0/LineID:647
0
36
1
NULL_REF
DL

0
0

SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderLineReference"), $TAC[  $TARCount ])
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646/SEQUENCE1:0/LineID:647/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(@Transaction_Reference) > 0 OR STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLine"), $TAC[  $TARCount ])) > 0
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
5
$tmp = "";

IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineSchemeID"), $TAC[1]) <> "" {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineSchemeID"), $TAC[1]);
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/ID:3/schemeID:0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = @Transaction_Reference;

IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLine"), $TAC[1]) <> "" {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLine"), $TAC[1]);
}
ELSE {
	$tmp = @Transaction_Reference;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/DocumentTypeCode:47
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
8
$tmp = "";

IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineDocTypeCode"), $TAC[1]) <> "" {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineDocTypeCode"), $TAC[1]);
}
ELSE {
	$tmp = "130";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/DocumentTypeCode:47/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Description:41
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
2
DECLARE $decimals INTEGER;
DECLARE $trans_amt STRING;
37
$tmp = "";
$decimals = 0;
$trans_amt = 0;

$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "LineDescription"), $TAC[  $TARCount ]);

$Employee_Number = @Employee_No;
IF (TRIMRIGHT($Employee_Number) = "") {
   $Employee_Number = "NA";
}

$decimals = 0;
$decimals = INFODATA.FETCH_MINORUNIT_FROM(@Currency_Code_ISO);

IF $decimals = 0 {
   $trans_amt = @Transaction_Amount;
} 
ELSE IF $decimals = 1 {
   $trans_amt = FORMAT("%.1f", @Transaction_Amount * 10);
} 
ELSE IF $decimals = 2 {
   $trans_amt = FORMAT("%.2f", @Transaction_Amount);
} 
ELSE IF $decimals = 3 {
   $trans_amt = FORMAT("%.3f", @Transaction_Amount / 10);
}

IF @Sign_mark_1 = "-" {
   $trans_amt = "-" & $trans_amt;
}

IF $tmp = "" {
   $tmp = "Name: " &  @Passenger_Name & 
       ", Amount: " & $trans_amt & ", CurrencyCode: " & @Currency_Code_ISO & 
       ", ExchangeRate: " & @Billing_Exchange_Rate & ", Transaction Reference: " & @Transaction_Reference & 
       ", EmployeeNumber: " & $Employee_Number;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Product_Text:871
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Description:41/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Product_Text:871
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "True" OR ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "Travel"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
12
$tmp = "";

IF ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "True" {
   $tmp = SEBTAC.CustomerArticleID($SEBKort_PartnerAttribute.$PartnerKey & "_" & @@);
}
ELSE IF ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "Travel" {
   $tmp = SEBTAC.CustomerArticleID($SEBKort_PartnerAttribute.$PartnerKey & "_" & @Article_NumberAlfa);
}

IF $tmp = "" {
   $tmp = TrimLeft(@@, "0");
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Article_Number:327
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
11
$tmp = "";

IF ParamFun.GetParamValue( $ConfArr, "ArticleNrSeller") = "True" {
	$tmp = @@;
} 
ELSE IF ParamFun.GetParamValue( $ConfArr, "ArticleNrSeller") = "Travel" {
	$tmp = @Article_NumberAlfa;
}
ELSE {
	$tmp = @@;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Article_Number:327
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "ArticleNrStandard") = "True"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Article_Number:327
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
11
$tmp = "";

IF $TAC[$TARCount].$VATPercent = 0 {
	$tmp = "E";
} 
ELSE IF $VATMode = "GROSS" {
   $tmp = "E";
}
ELSE {
	$tmp = "S";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216
0
36
1
NULL_REF
DL

0
0

$tmp 
1
0
0
11
$tmp = "";

IF $VATMode = "EXACT1" {
   $tmp = FORMAT("%.1f", $TAC[$TARCount].$VATPercent);
}
ELSE IF $VATMode = "NORMAL" OR $VATMode = "NORMALSPAN" OR $VATMode = "NORMALINT" {
   $tmp = FORMAT("%.1f", $TAC[ $TARCount ].$VATPercent);
}
ELSE IF $VATMode = "GROSS" {
   $tmp = 0;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/VAT_Percent:490
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PassengerName:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PassengerName:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PassengerName:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PASSENGER_NAME", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Passenger name";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Passenger_Name:874
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PassengerName:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PassengerName:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Passenger_Name:874
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PassengerName:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_CustomerCostCenter:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_CustomerCostCenter:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_CustomerCostCenter:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_CUSTCOSTCTR", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Customer cost center";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Customer_Cost_Centre:305
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_CustomerCostCenter:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_CustomerCostCenter:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Customer_Cost_Centre:305
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_CustomerCostCenter:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ProjectNumber:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ProjectNumber:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ProjectNumber:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PROJNR", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Project number";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Project_No:849
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ProjectNumber:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ProjectNumber:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Project_No:849
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ProjectNumber:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Department:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Department:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Department:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_DEP", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Department";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_Department_Number:301
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Department:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Department:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_Department_Number:301
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Department:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RequsitionOrderNumber:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RequsitionOrderNumber:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RequsitionOrderNumber:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_REQORDNR", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Requisition/Order number";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Requisition_Order_No:870
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RequsitionOrderNumber:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RequsitionOrderNumber:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Requisition_Order_No:870
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RequsitionOrderNumber:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Employee_no:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Employee_no:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Employee_no:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_EMPLNR", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Employee number";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_No:873
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Employee_no:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Employee_no:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_No:873
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Employee_no:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ExternalReference:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ExternalReference:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ExternalReference:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_EXTREF", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "External reference";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/External_Reference:316
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ExternalReference:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ExternalReference:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/External_Reference:316
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ExternalReference:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OrderedBy:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OrderedBy:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OrderedBy:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ORDERBY", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Ordered by";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ordered_By:302
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OrderedBy:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OrderedBy:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ordered_By:302
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OrderedBy:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
@Departure_Date_1_4 > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_DepartureDate:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_DepartureDate:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_DepartureDate:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_DEPDATE", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Departure date";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Departure_Date_1_4:850
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_DepartureDate:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_DepartureDate:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF STRLEN(@@) = 6 {
   $tmp = DMU.DateConvert(@@, "%y%m%d", "%Y-%m-%d");
}
ELSE {
   $tmp = DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d");
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Departure_Date_1_4:850
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_DepartureDate:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
@Return_Date > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ReturnDate:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ReturnDate:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ReturnDate:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_RETDATE", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Return date";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Return_Date:308
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ReturnDate:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ReturnDate:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

 DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d")
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Return_Date:308
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_ReturnDate:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
@Ticket_Number <> 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TicketNumber:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TicketNumber:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TicketNumber:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_TICKET_NUMBER", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Ticket number";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ticket_Number:307
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TicketNumber:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TicketNumber:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ticket_Number:307
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TicketNumber:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Routing_in_Text, " ")) > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingInText:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingInText:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingInText:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ROUTINTEXT", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Routing in text";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Routing_in_Text:282
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingInText:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingInText:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
1
# TRIMRIGHT($tmp, "-")
2
#$tmp = "";
#$tmp = @@ & "-" & @Routing_Text_2 & "-" & @Routing_Text_3 & "-" & @Routing_Text_4 & "-" & @Routing_Text_5;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Routing_in_Text:282
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingInText:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(TRIMLEFT($routing_code, " ")) > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingCodes:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingCodes:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingCodes:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ROUTECODES", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Routing codes";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingCodes:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingCodes:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

$routing_code
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingCodes:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(TRIMLEFT(@Routing_End_Destination, " ")) > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RoutingEndDest"), $TAC[  $TARCount ])) = "ON"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingEndDest:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingEndDest:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingEndDest:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ROUTING_END_DEST", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Routing end destination";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingEndDest:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingEndDest:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Routing_End_Destination:501
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_RoutingEndDest:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TurnAroundPoint:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TurnAroundPoint:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TurnAroundPoint:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_TURNPNT", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Turn around point";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Turn_Around_Point:330
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TurnAroundPoint:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TurnAroundPoint:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Turn_Around_Point:330
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_TurnAroundPoint:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Descriptive_Text:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Descriptive_Text:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Descriptive_Text:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_DESCTEXT", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Descriptive text";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Descriptive_Text:876
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Descriptive_Text:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Descriptive_Text:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Descriptive_Text:876
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Descriptive_Text:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$CreateVAT=1
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_VAT:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_VAT:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_VAT:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_TRVLVAT", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Travel agency VAT";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/VAT_Amount:29
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_VAT:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_VAT:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

TRIMLEFT($tmp, "+")
1
0
0
3
$tmp = "";

$tmp = @Sign_Mark_2 & @@;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/VAT_Amount:29
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_VAT:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$VATMode = "GROSS" AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Net_amount:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Net_amount:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Net_amount:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_NET", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Net amount";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Net_amount:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Net_amount:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

TRIMLEFT($tmp, "+")
1
0
0
1
$tmp = @Net_Amount_Sign_Mark & @Net_Amount;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Net_amount:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
$CreateGross=1
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Gross_amount:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Gross_amount:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Gross_amount:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_GROSS", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Gross amount";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_Gross_amount:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(@../../TRA/Previous_Invoice_Delivery_Note_No) <> 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF" AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "PrevDeliveryNote"), $TAC[  $TARCount ])) = "ON"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PrevDeliveryNote:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PrevDeliveryNote:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PrevDeliveryNote:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PREVDELNOTENO", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Previous delivery note no";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PrevDeliveryNote:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PrevDeliveryNote:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
5
$tmp = @../../TRA/Previous_Invoice_Delivery_Note_No;

IF STRLEN(@../../TRA/Previous_Invoice_Delivery_Note_No) = 0 {
	$tmp = "NA";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_PrevDeliveryNote:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(@Original_Freja_Invoice_No) <> 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OriginalInvoiceNo:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OriginalInvoiceNo:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OriginalInvoiceNo:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PREVINVNO", $InvoiceLanguage, $InvoiceLanguageDebug);

IF TRIMLEFT($tmp, " ") = "" {
   $tmp = "Original invoice number";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OriginalInvoiceNo:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OriginalInvoiceNo:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] ) & @Original_Freja_Invoice_No;
}
ELSE {
   $tmp = @Original_Freja_Invoice_No;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_OriginalInvoiceNo:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalItemPropertyName1"), $TAC[  $TARCount ])) > 0 
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_StringControlled:467
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_StringControlled:467/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_StringControlled:467/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
3
$tmp = "";

$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalItemPropertyName1"), $TAC[  $TARCount ]);
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_StringControlled:467/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_StringControlled:467/SEQUENCE1:0/Value:152
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
$tmp = "";

$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalItemPropertyValue1"), $TAC[  $TARCount ]);

IF $tmp = "" {
   $tmp = "NA";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty_StringControlled:467/SEQUENCE1:0/Value:152/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Currency_Code_ISO:26
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/currencyID:0
36
1
NULL_REF
DL

0
0

TRIMLEFT(FORMAT("%.2f", $tmp), "-")
1
1
0
12
IF $VATMode = "SFTI" {
  $tmp = @Billing_Amount;
} 
ELSE IF $VATMode = "GROSS" {
   $tmp = FORMAT("%.2f", $TAC[$TARCount].$gross);
}
ELSE {
   $tmp = $TAC[$TARCount].$Net;
}
IF @@ = 0 {
	$tmp = "0.00";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Net_Amount:837
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714
0
36
1
NULL_REF
DL

0
0

"1"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Net_Amount:837
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714/value:0
37
1
NULL_REF
SL

0
0
1
0
0
$AdjInvType <> "I"
0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701
0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$ADDCount
1
0
0
1
$ADDCount = $ADDCount + 1;
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/InvoicedQuantity:702
0
36
1
NULL_REF
DL

0
0

"EA"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/InvoicedQuantity:702/unitCode:0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
6
IF @Sign_Mark_3 = "-"

{    $tmp = "-1"; }
ELSE

{    $tmp = "1"; }
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/InvoicedQuantity:702/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/LineExtensionAmount:703
0
36
1
NULL_REF
DL

0
0
$AdjInvType <> "I"

1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
36
1
NULL_REF
DL

0
0

TRIMLEFT($tmp, "+")
1
1
0
6
IF @Billing_Amount = 0 OR @Billing_Amount = "" {
   $tmp = "0.00";
}
ELSE {
   $tmp = @Sign_Mark_3 &  @Billing_Amount;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/LineExtensionAmount:703/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

TRIMRIGHT($tmp, " ")
1
0
2
DECLARE $article_name[] STRING;
DECLARE $empty_s_1[] CONSTANT STRING;
26
$article_name = $empty_s_1;
$tmp = "";

$article_name = SL_STRING.FieldExplode(@@, " ");

# If there are spaces in the data, assume first value is MASKINELT and try to remove it
IF ARRAYSIZE($article_name) > 1 {
   FOR $i = 1 TO ARRAYSIZE($article_name) {
      # Skip the first 3 values as they are not needed (e.g. DIV POST MEMBER ÅRSPRIS)
      IF $i > 3 {
         $tmp = $tmp & $article_name[$i] & " ";
      } 
   }
   IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type <> "R" {
      IF STRLEN(TRIMLEFT(@Transaction_Reference)) > 0 {
         $tmp = $tmp & " - " & @Transaction_Reference;
      }
   }
}
ELSE {
   $tmp = @@;
}

IF $tmp = "" {
   $tmp = @@;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Transaction_Text:340
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0
$AdjInvType <> "I"
"E"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216
0
36
1
NULL_REF
DL

0
0
$AdjInvType <> "I"
"0"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0
$AdjInvType <> "I"
"VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
36
1
NULL_REF
DL

0
0
$AdjInvType <> "I"

1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/currencyID:0
36
1
NULL_REF
DL

0
0
$AdjInvType <> "I"
$tmp
1
0
0
6
IF @Billing_Amount = 0 {
   $tmp = "0.00";
}
ELSE  {
   $tmp = @Billing_Amount;
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714
0
36
1
NULL_REF
DL

0
0

"1"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_Adjustments:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714/value:0
37
1
NULL_REF
SL

0
0
0
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701
0
37
1
NULL_REF
SL

0
0
1
0
0

0
1
$ADDCount = $ADDCount + 1;
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701
0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

$ADDCount
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Note:23
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
24
$tmp = "";
IF @Orig_Invoice_Number <> "" {
	$tmp = "Ursprungligt faktura nummer: " & TRIMLEFT(@Orig_Invoice_Number, "0") & ", ";
}
IF @Orig_Invoice_Date <> "" {
	$tmp = $tmp & "Ursprungligt faktura datum: " & DMU.DateConvert( @Orig_Invoice_Date, "%Y%m%d", "%Y-%m-%d") & ", ";
}
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Interest_Inv_Interest_Rate <> "" {
	$tmp = $tmp & "Straffränta: " & FORMAT("%.2f",(@/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Interest_Inv_Interest_Rate)/100) & " %, ";
}
IF @Interest_Calc_Base_Amount <> "" {
	$tmp = $tmp & "Ränteberäknings belopp: " & @Interest_Calc_Base_Amount & ", ";
}
IF @Interest_Calc_To_Date <> "" AND @Interest_Calc_To_Date <> "00000000" {
	$tmp = $tmp & "Betaldatum: " & DMU.DateConvert( @Interest_Calc_To_Date, "%Y%m%d", "%Y-%m-%d") &  ",";
}
IF @Orig_Invoice_Amount <> "" {
	$tmp = $tmp & "Ursprungligt faktura belopp: " & @Orig_Invoice_Amount & ", ";
}
IF @Orig_Invoice_Due_Date <> "" {
	$tmp = $tmp & "Ursprungligt förfallodatum: " & DMU.DateConvert( @Orig_Invoice_Due_Date, "%Y%m%d", "%Y-%m-%d") & ", ";
}

$tmp = TRIMRIGHT($tmp, ", ");
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Note:23/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/InvoicedQuantity:702
0
36
1
NULL_REF
DL

0
0

"EA"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/InvoicedQuantity:702/unitCode:0
36
1
NULL_REF
DL

0
0

"1"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/InvoicedQuantity:702/value:0
37
1
NULL_REF
SL

0
0
0
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/LineExtensionAmount:703
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/LineExtensionAmount:703
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
36
1
NULL_REF
DL

0
0

$tmp
1
1
0
7
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "I" 
AND @Interest_Amount_Calc > 0  {
	$tmp = @Interest_Amount_Calc;
} 
ELSE {
	$tmp = "0.00";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/LineExtensionAmount:703/value:0
37
1
NULL_REF
SL

0
0
1
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4
0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
13
$tmp = "-";

/*
$tmp = @@;

IF STRLEN($tmp) > 17 {
	$tmp = $tmp[17, STRLEN($tmp)];
}

IF $AdjInvType = "R" {
   $tmp = "Original invoice information";
}
*/
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Transaction_Text:340
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"E"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216
0
36
1
NULL_REF
DL

0
0

"0"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
36
1
NULL_REF
DL

0
0

"VAT"
1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Price:712
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Price:712/SEQUENCE1:0
0
37
1
NULL_REF
SL

0
0
0
0
0

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
37
1
NULL_REF
SL

0
0
1
1
-1

0
0
0
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
36
1
NULL_REF
DL

0
0


1
0
0
0
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/currencyID:0
36
1
NULL_REF
DL

0
0

$tmp
1
0
0
7
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "I" 
AND @Interest_Amount_Calc > 0 {
	$tmp = @Interest_Amount_Calc;
} 
ELSE {
	$tmp = "0.00";
}
0
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine_ADD:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/value:0
