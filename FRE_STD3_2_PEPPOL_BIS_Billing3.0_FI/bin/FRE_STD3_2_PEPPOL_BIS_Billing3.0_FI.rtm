$RTIME:BEGIN
2.0
33
15
NULL_REF
FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI
Freja STD3 to PEPPOL BIS Billing 3.0 for Finland
0
2048
17
FRE_STD3_PEPPOL3.0.adf
17
UBL_21_Invoice.adf
0
0
46
4132
0
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
urn:cen.eu:en16931:2017#compliant#urn:fdc:peppol.eu:2017:poacc:billing:3.0
0
0

4132
1
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
urn:fdc:peppol.eu:2017:poacc:billing:01:1.0
0
0

4132
2
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
380
0
0

4132
3
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
LIT_0
UTF-8
0
0

8228
0
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$VATMode

0
0
1
0

8228
1
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Empty

0
0
1
0

8228
2
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$SumGross

0
0
3
0

8228
3
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$R_SUMVAT_COUNTER

0
0
2
0

8228
4
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$SumVAT

0
0
3
0

8228
5
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$TARCount

0
0
2
0

8228
6
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$tmp

0
0
1
0

8228
7
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Row_no

0
0
2
0

8228
8
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$BuyerReference_mapped

0
0
1
0

8228
9
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$routing_code

0
0
1
0

8228
10
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$return_date

0
0
1
0

8228
11
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$decimals

0
0
1
0

8228
12
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$departure_date

0
0
1
0

8228
13
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Employee_Number

0
0
1
0

8228
14
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$note

0
0
1
0

8228
15
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$note2

0
0
1
0

8228
16
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$org_no

0
0
1
0

8228
17
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote

0
0
1
1

8228
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Establishment_nr

0
0
1
1

8228
19
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote_tmp

0
0
1
0

8228
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Establishment_tmp

0
0
1
0

8228
21
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Attachment_id_cnt

0
0
2
0

8228
22
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote_cnt

0
0
2
0

8228
23
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$DelNote_out

0
0
1
1

8228
25
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$base64encodedPDF

0
0
1
1

8228
24
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Sum_VAT_calculated

0
0
3
0

8228
26
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$endpoint

0
0
1
0

8228
27
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$AdjInvType

0
0
1
0

8228
28
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$ADDCount

0
0
2
0

8228
29
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$CreateInvoicePDF

0
0
1
0

8228
30
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$FindDeliveryNotePDF

0
0
1
0

8228
31
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$InvoiceCountry

0
0
1
0

8228
32
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Sum_NET

0
0
3
0

8228
34
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Sum_GROSS

0
0
3
0

8228
35
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Article_3050_exist

0
0
2
0

8228
36
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$InvoiceLanguageDebug

0
0
1
0

8228
37
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$InvoiceLanguage

0
0
1
0

8228
38
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Total_calc_amount

0
0
3
0

8228
39
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$Total_amount

0
0
3
0

8228
40
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$CreateVAT

0
0
2
0

8228
41
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$CreateGross

0
0
2
0

8228
33
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0
$IBAN

0
0
1
0

1
32770
1
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15
GRH_LOOP
SLN Based on GRH_LOOP
0
0
0
0
0

333
444
1
#AD  ;MB[1] 

0
444
364
DECLARE $TAC[] 	RECORD SEBTAC.TAC;  ;MB[1] 
DECLARE $i 		INTEGER;  ;MB[1] 
DECLARE $ConfArr [][] STRING;  ;MB[1] 
DECLARE $VATList[] FLOAT;  ;MB[1] 
DECLARE $R_SUMVAT[][]  FLOAT;  ;MB[1] 
DECLARE $IsInList	INTEGER;  ;MB[1] 
DECLARE $vaHits		INTEGER;  ;MB[1] 
DECLARE $VATReason STRING;  ;MB[1] 
DECLARE $empty_s_1[] CONSTANT STRING;  ;MB[1] 
DECLARE $pdf_ix INTEGER;  ;MB[1] 
DECLARE $base64encodedPDF_tmp STRING;  ;MB[1] 
DECLARE $base64encodedPDF[] STRING;  ;MB[1] 
DECLARE $Stop INTEGER;  ;MB[1] 
DECLARE $GenericAttr RECORD SEBKORT_ATTRIBUTES.GenericRecord;  ;MB[1] 
  ;MB[1] 
$Empty = "";  ;MB[1] 
$DelNote = $empty_s_1;  ;MB[1] 
$Establishment_nr = $empty_s_1;  ;MB[1] 
$DelNote_out = $empty_s_1;  ;MB[1] 
$base64encodedPDF_tmp= "";  ;MB[1] 
$base64encodedPDF = $empty_s_1;  ;MB[1] 
$pdf_ix = 0;  ;MB[1] 
$FindDeliveryNotePDF = "";  ;MB[1] 
$CreateInvoicePDF = "";  ;MB[1] 
$InvoiceCountry = "";  ;MB[1] 
$Sum_VAT_calculated = 0;  ;MB[1] 
$Sum_NET = 0;  ;MB[1] 
$Sum_GROSS = 0;  ;MB[1] 
$Article_3050_exist = $false;  ;MB[1] 
$CreateVAT = 1;  ;MB[1] 
$CreateGross = 1;  ;MB[1] 
  ;MB[1] 
  ;MB[1] 
# Get the generic attribute and see if invoice- and/or delivery note PDF should be handeled  ;MB[1] 
TRY {   ;MB[1] 
	 NOLOG {  ;MB[1] 
      $AttributeValue = MBC_HIERCHMSGENV.GetAttribute($SessionId, $MessageId, SEBKORT_ATTRIBUTES.$Generic);   ;MB[1] 
      UNSERIALIZE $AttributeValue INTO $GenericAttr;  ;MB[1] 
   }  ;MB[1] 
}   ;MB[1] 
CATCH $Exception   ;MB[1] 
WHEN OTHERS {}  ;MB[1] 
  ;MB[1] 
IF ARRAYSIZE($GenericAttr.$Ref) > 0 {  ;MB[1] 
   FOR $i = 1 TO ARRAYSIZE($GenericAttr.$ref) {  ;MB[1] 
      IF $GenericAttr.$ref[$i] = "CreateInvoicePDF" {  ;MB[1] 
         $CreateInvoicePDF = $GenericAttr.$value[$i];  ;MB[1] 
      }  ;MB[1] 
      ELSE IF $GenericAttr.$ref[$i] = "FindDeliveryNotePDF" {  ;MB[1] 
         $FindDeliveryNotePDF = $GenericAttr.$value[$i];  ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
}  ;MB[1] 
ELSE {   ;MB[1] 
         $CreateInvoicePDF = "0";  ;MB[1] 
         $FindDeliveryNotePDF = "0";  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
IF DMSIM.Simulating() {  ;MB[1] 
$SEBKort_PartnerAttribute.$Parameter6 = "BuyerReference¤#CustCostCtr#;InvoiceNote¤Avvikande moms (dvs ej 6%, 12% eller 25% moms) kan förekomma på resefakturor.+CRNL+Har du frågor om följesedeln, ring Lingmerths: 010-122 68 96+CRNL+Har du frågor om fakturan, ring TAC Support: 08-14 68 60.+CRNL+Resenärer (netto):+SUM|PassName|N;";  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
# First get the configuration parameters from Map Control String.  ;MB[1] 
$ConfArr = ParamFun.ExplodeParStrToArr( $tmp, $SEBKort_PartnerAttribute.$Parameter6, ";", "¤" );  ;MB[1] 
  ;MB[1] 
# Get VATMode  ;MB[1] 
$tmp = ParamFun.GetParamValue( $ConfArr, "VATMode");  ;MB[1] 
  ;MB[1] 
IF $tmp = "" {   ;MB[1] 
	$VATMode = "NORMAL";  ;MB[1] 
} ELSE {  ;MB[1] 
	$VATMode = $tmp;  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
  ;MB[1] 
# Then read the potential TAC data for dynamic mapping.  ;MB[1] 
$TAC = SEBTAC.GetSTD3TACData( $SessionId, $MessageId );  ;MB[1] 
  ;MB[1] 
# Loop through all lines and make VAT sums for each VAT %  ;MB[1] 
FOR $i = 1 TO ARRAYSIZE( $TAC ) {  ;MB[1] 
   $TAC[$i].$VAT_is_deviant = $False;  ;MB[1] 
  ;MB[1] 
   # VAT summaries  ;MB[1] 
   $SumVAT = $SumVAT + $TAC[$i].$VAT;  ;MB[1] 
   $SumGross = $SumGross + $TAC[$i].$Gross;  ;MB[1] 
  ;MB[1] 
   IF $VATMode = "EXACT1" {  ;MB[1] 
      $TAC[$i].$VATPercent = TRIMLEFT(($TAC[$i].$VATInvCur / $TAC[$i].$Net)*100, "-");   ;MB[1] 
	    $TAC[$i].$VATPercent = FORMAT("%.1f", $TAC[$i].$VATPercent);  ;MB[1] 
   }  ;MB[1] 
  ;MB[1] 
   IF $VATMode = "NORMALSPAN" {  ;MB[1] 
		  # Kod för att hantera ett momsspann. / Special för Sverige...  ;MB[1] 
      IF $TAC[$i].$VATPercent > 20 AND $TAC[$i].$VATPercent < 28 {   ;MB[1] 
         $TAC[$i].$VATPercent = 25  ;   ;MB[1] 
      }  ;MB[1] 
      ELSE IF $TAC[$i].$VATPercent > 10 AND $TAC[$i].$VATPercent < 15 {   ;MB[1] 
         $TAC[$i].$VATPercent = 12  ;   ;MB[1] 
      }  ;MB[1] 
      ELSE IF $TAC[$i].$VATPercent >  4 AND $TAC[$i].$VATPercent <  8 {  ;MB[1] 
         $TAC[$i].$VATPercent = 6 ;   ;MB[1] 
      }  ;MB[1] 
      ELSE IF $TAC[$i].$VATPercent  < 2 {   ;MB[1] 
         $TAC[$i].$VATPercent = 0  ;   ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
   IF $VATMode = "NORMALINT" {        #      We roundoff values to integers....  ;MB[1] 
      IF $TAC[$i].$VATPercent > 24.5 AND $TAC[$i].$VATPercent < 25.5 {  ;MB[1] 
         $TAC[$i].$VATPercent = 25  ;   ;MB[1] 
      }  ;MB[1] 
      ELSE IF $TAC[$i].$VATPercent > 11.5 AND $TAC[$i].$VATPercent < 12.5 {  ;MB[1] 
         $TAC[$i].$VATPercent = 12  ;   ;MB[1] 
      }  ;MB[1] 
      ELSE IF $TAC[$i].$VATPercent >  5.5 AND $TAC[$i].$VATPercent <  6.5 {  ;MB[1] 
         $TAC[$i].$VATPercent = 6 ;   ;MB[1] 
      }  ;MB[1] 
      ELSE IF $TAC[$i].$VATPercent < 0.5 {  ;MB[1] 
         $TAC[$i].$VATPercent = 0  ;   ;MB[1] 
      }  ;MB[1] 
   }     ;MB[1] 
   IF $VATMode = "NORMAL" OR $VATMode = "NORMALSPAN" OR $VATMode = "NORMALINT" {   ;MB[1] 
      $TAC[$i].$VATPercent = FORMAT("%.1f", $TAC[$i].$VATPercent);   ;MB[1] 
   }  ;MB[1] 
     ;MB[1] 
   IF $VATMode = "GROSS" {  ;MB[1] 
      $TAC[$i].$VAT = 0;  ;MB[1] 
      $TAC[$i].$VATPercent = 0;  ;MB[1] 
      $TAC[$i].$Net = $TAC[$i].$Gross;  ;MB[1] 
      $TAC[$i].$VAT_is_deviant = $True;  ;MB[1] 
   }  ;MB[1] 
     ;MB[1] 
   IF $CreateInvoicePDF = "2" {  ;MB[1] 
      # Don't adjust any VAT rates for PDF only invoices  ;MB[1] 
   }  ;MB[1] 
   ELSE {  ;MB[1] 
      # Check if VAT is correct or not. If incorrect, sum the current line with 0 VAT and gross as line amount and replace input net with gross  ;MB[1] 
         IF $TAC[$i].$VATPercent = 25.5 OR $TAC[$i].$VATPercent = 24 OR $TAC[$i].$VATPercent = 14 OR $TAC[$i].$VATPercent = 10 OR $TAC[$i].$VATPercent = 0 {  ;MB[1] 
         # VAT is accurate, rounding amount will fix any calculation errors.  ;MB[1] 
      }  ;MB[1] 
      ELSE {  ;MB[1] 
         IF $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100) <> $TAC[$i].$VAT OR $VATMode = "GROSS"{  ;MB[1] 
            $TAC[$i].$VAT = 0;  ;MB[1] 
            $TAC[$i].$VATPercent = 0;  ;MB[1] 
            $TAC[$i].$Net = $TAC[$i].$Gross;  ;MB[1] 
            $TAC[$i].$VAT_is_deviant = $True;  ;MB[1] 
         }  ;MB[1] 
         ELSE {  ;MB[1] 
            # Do nothing, array is already correct  ;MB[1] 
         }  ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
   $IsInList = 0;  ;MB[1] 
   $vaHits = 1;  ;MB[1] 
  ;MB[1] 
   IF ARRAYSIZE($VATList) = 0 {  ;MB[1] 
  ;MB[1] 
	    $VATList[1]         = $TAC[$i].$VATPercent ;  ;MB[1] 
	    $R_SUMVAT[1][1]     = $TAC[$i].$VATPercent ;  ;MB[1] 
	    $R_SUMVAT[1][2]     = $TAC[$i].$Net ;  ;MB[1] 
	    $R_SUMVAT[1][3]     = $TAC[$i].$VAT ;  ;MB[1] 
	    $R_SUMVAT[1][4]     = $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100);  ;MB[1] 
   }   ;MB[1] 
   ELSE {  ;MB[1] 
	    $IsInList = DMU.ListFind($TAC[$i].$VATPercent, $VATList) ;  ;MB[1] 
  ;MB[1] 
	    IF $IsInList {  ;MB[1] 
		     $R_SUMVAT[$IsInList][2]   = $R_SUMVAT[$IsInList][2] + $TAC[$i].$Net ;  ;MB[1] 
		     $R_SUMVAT[$IsInList][3]   = $R_SUMVAT[$IsInList][3] + $TAC[$i].$VAT ;  ;MB[1] 
		     $R_SUMVAT[$IsInList][4]   = $R_SUMVAT[$IsInList][4] + $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100);  ;MB[1] 
	    }  ;MB[1] 
	    ELSE {  ;MB[1] 
		     FOR $l = 1 TO ARRAYSIZE($VATList) {  ;MB[1] 
			      IF $VATList[$vaHits] < $TAC[$i].$VATPercent {  ;MB[1] 
				       $vaHits = $vaHits + 1 ;  ;MB[1] 
            }  ;MB[1] 
         }  ;MB[1] 
                      ;MB[1] 
         ARRAY INSERT $VATList FROM $vaHits ;  ;MB[1] 
         $VATList[$vaHits]         = $TAC[$i].$VATPercent ;  ;MB[1] 
         ARRAY INSERT $R_SUMVAT FROM $vaHits ;  ;MB[1] 
         $R_SUMVAT[$vaHits][1]     = $TAC[$i].$VATPercent ;  ;MB[1] 
         $R_SUMVAT[$vaHits][2]     = $TAC[$i].$Net;           # [plats i listan][datainnehåll]  ;MB[1] 
         $R_SUMVAT[$vaHits][3]     = $TAC[$i].$VAT;  ;MB[1] 
         $R_SUMVAT[$vaHits][4]     = $TAC[$i].$Net * ($TAC[$i].$VATPercent / 100);  ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
   IF $TAC[$i].$VATPercent < 0.2 AND $VATReason = "" {  ;MB[1] 
      $VATReason = "Exempt from Tax" ;  ;MB[1] 
   }   ;MB[1] 
  ;MB[1] 
   # Delivery note PDF preparations in case we have Attachment flag in the configuration string  ;MB[1] 
  ;MB[1] 
   IF $FindDeliveryNotePDF = "1" {  ;MB[1] 
  ;MB[1] 
      $Establishment_tmp = NYTTO.STRTOPOSIX(TRIMLEFT(TRIMRIGHT($TAC[$i].$EstNr)));  ;MB[1] 
      $DelNote_tmp = $TAC[$i].$ExtInvRef;  ;MB[1] 
  ;MB[1] 
      IF ARRAYSIZE($DelNote) = 0 {  ;MB[1] 
         $DelNote[1] = $DelNote_tmp ;      ;MB[1] 
         $Establishment_nr[1] = $Establishment_tmp;  ;MB[1] 
         $IsInList = $true;  ;MB[1] 
      }  ;MB[1] 
      ELSE {  ;MB[1] 
         # Check if this delivery note number is already stated  ;MB[1] 
         $IsInList = $false;  ;MB[1] 
         FOR $p = 1 TO ARRAYSIZE($DelNote) {  ;MB[1] 
            IF $DelNote_tmp = $DelNote[$p] {  ;MB[1] 
               $IsInList = $true;  ;MB[1] 
               BREAK;  ;MB[1] 
            }  ;MB[1] 
         }  ;MB[1] 
      }  ;MB[1] 
  ;MB[1] 
      IF NOT $IsInList {  ;MB[1] 
         $DelNote[ARRAYSIZE($DelNote) + 1] = $DelNote_tmp ;   ;MB[1] 
         $Establishment_nr[ARRAYSIZE($Establishment_nr) + 1] = $Establishment_tmp;  ;MB[1] 
      }  ;MB[1] 
      ELSE {  ;MB[1] 
         # Reference is already in list, do nothing  ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
   # Check if article number 03050 exist on any of the invoice rows. Used for "AdditionalDocRef schemeId LEA" for Trafikverket  ;MB[1] 
   IF TRIMLEFT($TAC[$i].$ArtNr, "0") = "3050" {  ;MB[1] 
      $Article_3050_exist = $true;  ;MB[1] 
   }  ;MB[1] 
} # End FOR TAC  ;MB[1] 
  ;MB[1] 
# Loop through all PDFs and save only the ones that have data  ;MB[1] 
FOR $u = 1 TO ARRAYSIZE($DelNote) {  ;MB[1] 
   $base64encodedPDF_tmp = SEBTAC.GetDeliveryNotePDF($DelNote[$u], $Establishment_nr[$u], "resebyraer.dat");  ;MB[1] 
   IF STRLEN($base64encodedPDF_tmp) = 0 {  ;MB[1] 
      $DelNote[$u] = TRIMLEFT($DelNote[$u], "0");  ;MB[1] 
      $base64encodedPDF_tmp = SEBTAC.GetDeliveryNotePDF($DelNote[$u], $Establishment_nr[$u], "resebyraer.dat");  ;MB[1] 
   }  ;MB[1] 
   IF STRLEN($base64encodedPDF_tmp) > 0 {  ;MB[1] 
      $pdf_ix = $pdf_ix +1;  ;MB[1] 
      $base64encodedPDF[$pdf_ix] = $base64encodedPDF_tmp;  ;MB[1] 
      $DelNote_out[$pdf_ix] = $DelNote[$u];  ;MB[1] 
   }  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
# Log reference  ;MB[1] 
$LogRef_InvoiceNr = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Number;  ;MB[1] 
  ;MB[1] 
IF ParamFun.GetParamValue( $ConfArr, "RecipientNr") {  ;MB[1] 
   IF STRLEN(ParamFun.GetParamValue( $ConfArr, "RecipientNr")) = 13 {  ;MB[1] 
      $LogRef_GLN = ParamFun.GetParamValue( $ConfArr, "RecipientNr");  ;MB[1] 
      $LogRef_OrgNr = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Organization_No;  ;MB[1] 
   }  ;MB[1] 
   ELSE {  ;MB[1] 
      $LogRef_OrgNr = ParamFun.GetParamValue( $ConfArr, "RecipientNr");  ;MB[1] 
   }  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
IF ParamFun.GetParamValue( $ConfArr, "BUYERPARTYTAXSCHEMECOMPANYID") {  ;MB[1] 
   $LogRef_OrgNr = ParamFun.GetParamValue( $ConfArr, "BUYERPARTYTAXSCHEMECOMPANYID");  ;MB[1] 
}  ;MB[1] 
ELSE {  ;MB[1] 
   $LogRef_OrgNr = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Organization_No;  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
$LogRef_CompanyName = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Name;  ;MB[1] 
  ;MB[1] 
$LogRef_Tag1 = "IssueDate";  ;MB[1] 
$LogRef_Value1 = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Date;  ;MB[1] 
  ;MB[1] 
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Sign_Mark_3 = "-" {  ;MB[1] 
   $LogRef_Tag2 = "InvoiceType";  ;MB[1] 
   $LogRef_Value2 = "Credit";  ;MB[1] 
}  ;MB[1] 
ELSE {  ;MB[1] 
   $LogRef_Tag2 = "InvoiceType";  ;MB[1] 
   $LogRef_Value2 = "Debit";  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
$LogRef_Tag3 = "Currency";  ;MB[1] 
$LogRef_Value3 = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Currency_Code;  ;MB[1] 
  ;MB[1] 
# Check if this Adjustment invoice type should be sent if ADA/ADD excist  ;MB[1] 
IF $TAC[1].$OrigRecord = "ADA" {  ;MB[1] 
  ;MB[1] 
   $AdjInvType = @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type;  ;MB[1] 
  ;MB[1] 
   # Check if customer should receive RIA invoices. Default is ON  ;MB[1] 
   IF SL_STRING.ToUpper(ParamFun.GetParamValue( $ConfArr, "SendADA")) = "OFF" {  ;MB[1] 
      # Do not send ADA if no configuration for ADA  ;MB[1] 
      $StopMessageReason = "ADA invoice should not be sent! Config string SendADA is set to OFF.";   ;MB[1] 
   }   ;MB[1] 
  ;MB[1] 
   # Add the ADA billing amount to Sum array  ;MB[1] 
   $R_SUMVAT[1][1]     = "0" ;  ;MB[1] 
   $R_SUMVAT[1][2]     =  @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Sign_Mark_3 & @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Billing_Amount;  ;MB[1] 
   $R_SUMVAT[1][3]     = "0" ;  ;MB[1] 
   $R_SUMVAT[1][4]     = "0";  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
# Sum up the diffrent amounts   ;MB[1] 
FOR $i = 1 TO ARRAYSIZE($R_SUMVAT) {  ;MB[1] 
   $Sum_VAT_calculated = NYTTO.ROUNDOFF($Sum_VAT_calculated,2) + NYTTO.ROUNDOFF($R_SUMVAT[$i][4],2);  ;MB[1] 
   $Sum_NET = $Sum_NET + $R_SUMVAT[$i][2];  ;MB[1] 
   $Sum_GROSS = $Sum_VAT_calculated + $Sum_NET;  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
$Sum_VAT_calculated = NYTTO.ROUNDOFF($Sum_VAT_calculated, 2);  ;MB[1] 
$Sum_NET = NYTTO.ROUNDOFF($Sum_NET, 2);  ;MB[1] 
$Sum_GROSS = NYTTO.ROUNDOFF($Sum_GROSS, 2);  ;MB[1] 
  ;MB[1] 
# Check if we have configuration for invocie country (affects the invoice layout)  ;MB[1] 
IF STRLEN(ParamFun.GetParamValue( $ConfArr, "CustomerRegCountry")) > 0 {  ;MB[1] 
   $InvoiceCountry = ParamFun.GetParamValue( $ConfArr, "CustomerRegCountry");  ;MB[1] 
}  ;MB[1] 
ELSE {  ;MB[1] 
   IF TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country, " ") = "" {  ;MB[1] 
      # If customer country is empty, use sending SEB country instead  ;MB[1] 
      $InvoiceCountry = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Sender_Country)))));  ;MB[1] 
   }  ;MB[1] 
   ELSE {  ;MB[1] 
      IF STRLEN(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country))) = 2 { # Assume correct country code from Freja  ;MB[1] 
         $InvoiceCountry = TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country));  ;MB[1] 
      }  ;MB[1] 
      ELSE {  ;MB[1] 
         $InvoiceCountry = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Customer_Country)))));  ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
# Get invoice language  ;MB[1] 
IF NOT DMSIM.Simulating() {  ;MB[1] 
   NOLOG {  ;MB[1] 
      TRY {  ;MB[1] 
         $InvoiceLanguage = MBC_HIERCHMSGENV.GetAttribute($SessionId, $MessageId, "InvoiceLanguage");  ;MB[1] 
      }  ;MB[1] 
      CATCH $exception  ;MB[1] 
      WHEN OTHERS {  ;MB[1] 
         $InvoiceLanguage = "EN";  ;MB[1] 
      }  ;MB[1] 
   }  ;MB[1] 
  ;MB[1] 
   # If there's a string configuration it will override any attribute controlled language  ;MB[1] 
   IF STRLEN(ParamFun.GetParamValue( $ConfArr, "InvoiceLanguage")) > 0 {  ;MB[1] 
      $InvoiceLanguage = ParamFun.GetParamValue( $ConfArr, "InvoiceLanguage");  ;MB[1] 
   }  ;MB[1] 
}   ;MB[1] 
ELSE {  ;MB[1] 
   $InvoiceLanguage = "EN";  ;MB[1] 
}  ;MB[1] 
  ;MB[1] 
/* Set hard to no until we've checked NCM for debug settings  ;MB[1] 
IF $SEBKort_PartnerAttribute.$DEBUG = 1 {  ;MB[1] 
   $InvoiceLanguageDebug = "Y";  ;MB[1] 
} ELSE {  ;MB[1] 
   $InvoiceLanguageDebug = "N";  ;MB[1] 
}  ;MB[1] 
*/  ;MB[1] 
$InvoiceLanguageDebug = "N";  ;MB[1] 
  ;MB[1] 
# Check if we will force creation of AdditionalItemProperty/Travel agency VAT and Gross amount.   ;MB[1] 
# AdditionalItemProperty/Travel agency VAT and Gross amount are used by PDF to fill data in columns, so we force creation   ;MB[1] 
# of these AdditionalItemProperties for the PDF to be ok.  ;MB[1] 
  ;MB[1] 
IF $CreateInvoicePDF = "0" AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[ARRAYSIZE($TAC)])) = "OFF" {  ;MB[1] 
   $CreateVAT = 0;  ;MB[1] 
   $CreateGross = 0;  ;MB[1] 
}  ;MB[1] 

0
333
GRH_LOOP
UBLInvoice
1
0
18
/Freja invoice:429/GRH_LOOP:701
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0
0
32770
2
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1
MBH_LOOP
SLN Based on MBH_LOOP
0
0
0
0
0

333
333
333
333
MBH_LOOP
UBLInvoice
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0
0
32770
3
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2
INH_LOOP
SLN Based on INH_LOOP
0
0
1
0
0

333
333
333
333
INH_LOOP
UBLInvoice
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0
0
32772
4
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3


0
0
1
1
333
333
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Encoding:0
32770
5
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3
INH
SLN Based on INH
0
0
1
0
0

333
333
333
333
INH
Invoice
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0
0
32770
6
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
31
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0
0
32770
7
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
CustomizationID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/CustomizationID:14
0
32772
8
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:7


0
0
1
1
333
333
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:0
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/CustomizationID:14/value:0
32770
9
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ProfileID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProfileID:15
0
32772
10
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:9


0
0
1
1
333
333
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:1
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProfileID:15/value:0
32770
11
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {  ;MB[12] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] ) & @@;  ;MB[12] 
}  ;MB[12] 
ELSE {  ;MB[12] 
   $tmp = @@;  ;MB[12] 
}  ;MB[12] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ID:3
0
32772
12
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:11


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Number:8
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ID:3/value:0
32770
13
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
IssueDate
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/IssueDate:19
0
32772
14
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:13


0
0
1
0
333
444
1
RETURN DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Date:9
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/IssueDate:19/value:0
32770
15
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
DueDate
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DueDate:21
0
32772
16
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:15


0
0
1
0
333
444
1
RETURN DMU.DateConvert(@Due_Date, "%Y%m%d", "%Y-%m-%d")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Due_Date:10
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DueDate:21/value:0
32770
17
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
InvoiceTypeCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceTypeCode:22
0
32772
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:17


0
0
1
1
333
333
4132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/LIT_0:2
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceTypeCode:22/value:0
32770
19
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
$TAC[1].$OrigRecord <> "ADA"
333
333
444
13
$tmp = "";  ;MB[20] 
  ;MB[20] 
IF $InvoiceCountry = "SE" {  ;MB[20] 
   $tmp = "OBS! Ej underlag för momsredovisning.\n";  ;MB[20] 
}  ;MB[20] 
  ;MB[20] 
IF $VATMode = "GROSS" {  ;MB[20] 
   $tmp = $tmp & " Net: " & TRIMLEFT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Net_Amount_Sign_Mark & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Net_Amount,"+") & " " & @Invoice_Currency_Code & ". VAT: " & TRIMLEFT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/MVA_Total_Amount_Sign_Mark & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/MVA_Total_Amount, "+") & " " & @Invoice_Currency_Code & ".\n";   ;MB[20] 
}  ;MB[20] 
  ;MB[20] 
IF SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "InvoiceNote"), $TAC, $VATMode) <> "" {  ;MB[20] 
   $tmp = $tmp & SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "InvoiceNote"), $TAC, $VATMode);  ;MB[20] 
}  ;MB[20] 

0
333
INH
Note
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23
0
32772
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:19


0
0
1
0
444
1
RETURN $InvoiceCountry = "SE" OR (SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "InvoiceNote"), $TAC, $VATMode) <> "")

0
444
1
RETURN TRIMRIGHT($tmp, "\n")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23/value:0
32770
21
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
0
0
@/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "R" OR @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "E"
333
333
333
333
INH
Note_ADA
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23
0
32770
22
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:21
ADA_LOOP
SLN Based on ADA_LOOP
0
0
0
1
1

333
333
333
333
ADA_LOOP
Note_ADA
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23
0
32770
23
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:21/ADA_LOOP:22
ADA
SLN Based on ADA
0
0
0
1
1

333
333
444
8
$tmp = "";  ;MB[24] 
  ;MB[24] 
IF @@ = "R" {  ;MB[24] 
   $tmp = "Invoice Remainder. Remainder no: " & TRIMLEFT(@Reminder_Inv_Reminder_Level, "0") & ".";  ;MB[24] 
}  ;MB[24] 
ELSE IF @@ = "E" {  ;MB[24] 
    $tmp = SEBTAC.GetTextTranslation("EVENT_INVOICE_TEXT", "FI", $InvoiceLanguageDebug); # This text should always be norweigan hence the "FI" hardcoding.  ;MB[24] 
}  ;MB[24] 

0
333
ADA
Note_ADA
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23
0
32772
24
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:21/ADA_LOOP:22/ADA:23


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Adjustment_Inv_Type:995
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Note:23/value:0
32770
25
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
DocumentCurrencyCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DocumentCurrencyCode:25
0
32772
26
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:25


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Currency_Code:774
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/DocumentCurrencyCode:25/value:0
32770
27
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AccountingCost"), $TAC[ ARRAYSIZE($TAC)] )) > 0
333
333
333
333
INH
AccountingCost
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCost:31
0
32772
28
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:27


0
0
1
0
333
444
1
RETURN SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AccountingCost"), $TAC[ARRAYSIZE($TAC)] )

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCost:31/value:0
32770
29
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
18
$tmp = "";  ;MB[30] 
  ;MB[30] 
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "BuyerReference"), $TAC[ARRAYSIZE($TAC)] );  ;MB[30] 
  ;MB[30] 
IF @../ADA_LOOP/ADA/Adjustment_Inv_Type = "I" OR @../ADA_LOOP/ADA/Adjustment_Inv_Type = "R" OR @../ADA_LOOP/ADA/Adjustment_Inv_Type = "E" OR @../ADA_LOOP/ADA/Adjustment_Inv_Type = "A"  ;MB[30] 
{  ;MB[30] 
	IF DMSIM.Simulating() {  ;MB[30] 
 		$tmp=$tmp & "ADABuyerReference¤xxxx";  ;MB[30] 
 		}  ;MB[30] 
	ELSE {  ;MB[30] 
		$tmp =  SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADABuyerReference"), $TAC[ARRAYSIZE($TAC)] );  ;MB[30] 
		}  ;MB[30] 
}  ;MB[30] 
  ;MB[30] 
  ;MB[30] 
IF STRLEN($tmp) = 0 {   ;MB[30] 
	$tmp = "NA";  ;MB[30] 
}  ;MB[30] 

0
333
INH
BuyerReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BuyerReference:33
0
32772
30
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:29


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BuyerReference:33/value:0
32770
31
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderReference"), $TAC[ ARRAYSIZE($TAC) ] )) > 0
333
333
333
333
INH
OrderReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42
0
32770
32
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:31
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42/SEQUENCE1:0
0
32770
33
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:31/INH:32
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42/SEQUENCE1:0/ID:3
0
32772
34
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:31/INH:32/INH:33


0
0
1
0
333
444
1
RETURN SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderReferencePrefix"), $TAC[ARRAYSIZE($TAC)] ) & SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderReference"), $TAC[ARRAYSIZE($TAC)] )

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/OrderReference:42/SEQUENCE1:0/ID:3/value:0
32770
35
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
@/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Sign_Mark_3 = "-" AND STRLEN(TRIMLEFT(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Original_Freja_Invoice_No, "0"), " ")) > 0
333
333
333
333
INH
BillingReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196
0
32770
36
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:35
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0
0
32770
37
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:35/INH:36
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
InvoiceDocumentReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197
0
32770
38
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:35/INH:36/INH:37
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197/SEQUENCE1:0
0
32770
39
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:35/INH:36/INH:37/INH:38
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 {  ;MB[40] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC) ] ) & @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Original_Freja_Invoice_No;  ;MB[40] 
}  ;MB[40] 
ELSE {  ;MB[40] 
   $tmp = @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Original_Freja_Invoice_No;  ;MB[40] 
}  ;MB[40] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197/SEQUENCE1:0/ID:3
0
32772
40
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:35/INH:36/INH:37/INH:38/INH:39


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/BillingReference:196/SEQUENCE1:0/InvoiceDocumentReference:197/SEQUENCE1:0/ID:3/value:0
32770
41
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ ARRAYSIZE($TAC) ] )) > 0
333
333
333
333
INH
ContractDocumentReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264
0
32770
42
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:41
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0
0
32770
43
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:41/INH:42
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0/ID:3
0
32772
44
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:41/INH:42/INH:43


0
0
1
0
333
444
1
RETURN SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] )

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0/ID:3/value:0
32770
45
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
ADA_LOOP
SLN Based on ADA_LOOP
0
0
1
0
0
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 AND SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADAContractDocumentReference"), $TAC[ ARRAYSIZE($TAC) ] ) <> "OFF"
333
333
333
333
ADA_LOOP
ContractDocumentReference_ADA
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264
0
32770
46
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:45
ADA
SLN Based on ADA
0
0
1
0
0

333
333
333
333
ADA
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0
0
32770
47
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:45/ADA:46
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
444
8
# First check if ContractDocumentReference string is there and use it  ;MB[48] 
  ;MB[48] 
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] );  ;MB[48] 
  ;MB[48] 
# Ovveride if ADAContractDocumentReference is present  ;MB[48] 
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADAContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] )) > 0 {  ;MB[48] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ADAContractDocumentReference"), $TAC[ARRAYSIZE($TAC)] );  ;MB[48] 
}  ;MB[48] 

0
333
ADA
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0/ID:3
0
32772
48
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:45/ADA:46/ADA:47


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ContractDocumentReference:264/SEQUENCE1:0/ID:3/value:0
32770
49
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
$CreateInvoicePDF = "1"
333
333
333
333
INH
AdditionalDocumentReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203
0
32770
50
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0
0
32770
51
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
1
$Attachment_id_cnt = $Attachment_id_cnt +1;  ;MB[52] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3
0
32772
52
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:51


0
0
1
0
333
444
1
RETURN $Attachment_id_cnt

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3/value:0
32770
53
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
DocumentDescription
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentDescription:54
0
32772
54
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:53


0
0
1
0
333
444
1
RETURN "Commercial invoice"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentDescription:54/value:0
32770
55
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Attachment
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55
0
32770
56
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:55
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0
0
32770
57
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:55/INH:56
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
EmbeddedDocumentBinaryObject
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56
0
32772
58
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:55/INH:56/INH:57


0
0
1
0
333
444
1
RETURN "application/pdf"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/mimeCode:0
32772
59
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:55/INH:56/INH:57


0
0
1
0
333
444
1
RETURN @Invoice_Number & ".pdf"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/filename:0
32772
60
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:49/INH:50/INH:55/INH:56/INH:57


0
0
1
0
333
444
1
RETURN ""

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/value:0
32770
61
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
ARRAYSIZE($base64encodedPDF)
-1

333
333
333
333
INH
AdditionalDocumentReference_DelNote
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203
0
32770
62
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0
0
32770
63
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
2
$Attachment_id_cnt = $Attachment_id_cnt +1;  ;MB[64] 
$DelNote_cnt = $DelNote_cnt +1;  ;MB[64] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3
0
32772
64
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:63


0
0
1
0
333
444
1
RETURN $Attachment_id_cnt

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3/value:0
32770
65
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
DocumentDescription
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentDescription:54
0
32772
66
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:65


0
0
1
0
333
444
1
RETURN "Delivery note"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentDescription:54/value:0
32770
67
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Attachment
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55
0
32770
68
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:67
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0
0
32770
69
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:67/INH:68
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
EmbeddedDocumentBinaryObject
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56
0
32772
70
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:67/INH:68/INH:69


0
0
1
0
333
444
1
RETURN "application/pdf"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/mimeCode:0
32772
71
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:67/INH:68/INH:69


0
0
1
0
333
444
1
RETURN $DelNote_out[$DelNote_cnt] & ".pdf"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/filename:0
32772
72
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:61/INH:62/INH:67/INH:68/INH:69


0
0
1
0
333
444
1
RETURN $base64encodedPDF[$DelNote_cnt]

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/Attachment:55/SEQUENCE1:0/EmbeddedDocumentBinaryObject:56/value:0
32770
73
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalDocumentReference"), $TAC[ ARRAYSIZE($TAC)] )) > 0
333
333
333
333
INH
AdditionalDocumentReference_string
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203
0
32770
74
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:73
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0
0
32770
75
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:73/INH:74
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
12
$tmp = "";  ;MB[76] 
  ;MB[76] 
# Special handling of LEA concept for Trafikverket  ;MB[76] 
IF $Article_3050_exist = $true AND SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC, $VATMode) = "LEA" {  ;MB[76] 
   $tmp = "LEA";  ;MB[76] 
}  ;MB[76] 
ELSE IF $Article_3050_exist = $false AND SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC, $VATMode) = "LEA" {  ;MB[76] 
   $tmp = "";  ;MB[76] 
}  ;MB[76] 
ELSE {  ;MB[76] 
   $tmp = SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC, $VATMode);  ;MB[76] 
}  ;MB[76] 

0
333
INH
ID
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3
0
32772
76
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:73/INH:74/INH:75


0
0
1
0
444
1
RETURN STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalDocRefSchemeID"), $TAC[1])) > 0

0
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3/schemeID:0
32772
77
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:73/INH:74/INH:75


0
0
1
0
333
444
1
RETURN SEBTAC.GetTACInvoiceNote($SEBKort_PartnerAttribute.$PartnerKey, ParamFun.GetParamValue( $ConfArr, "AdditionalDocumentReference"), $TAC, $VATMode)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/ID:3/value:0
32770
78
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:73/INH:74
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues(  ParamFun.GetParamValue( $ConfArr, "AddDocRefDocTypeCode"), $TAC[ ARRAYSIZE($TAC)] )) > 0
333
333
333
333
INH
DocumentTypeCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentTypeCode:47
0
32772
79
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:73/INH:74/INH:78


0
0
1
0
333
444
1
RETURN  ParamFun.GetParamValue( $ConfArr, "AddDocRefDocTypeCode")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AdditionalDocumentReference:203/SEQUENCE1:0/DocumentTypeCode:47/value:0
32770
80
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ProjNr"), $TAC[ ARRAYSIZE($TAC)] )) > 0
333
333
333
333
INH
ProjectReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271
0
32770
81
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:80
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271/SEQUENCE1:0
0
32770
82
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:80/INH:81
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
8
$tmp = "";  ;MB[83] 
  ;MB[83] 
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ProjNr"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {  ;MB[83] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ProjNr"), $TAC[ ARRAYSIZE($TAC)] );  ;MB[83] 
}  ;MB[83] 
ELSE {  ;MB[83] 
   $tmp = @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TRA/Project_No;  ;MB[83] 
}  ;MB[83] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271/SEQUENCE1:0/ID:3
0
32772
83
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:80/INH:81/INH:82


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/ProjectReference:271/SEQUENCE1:0/ID:3/value:0
32770
84
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
AccountingSupplierParty
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282
0
32770
85
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0
0
32770
86
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
AdditionalAccountID
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/AdditionalAccountID:284
0
32772
87
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:86


0
0
1
0
333
444
1
RETURN "ZZZ"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/AdditionalAccountID:284/schemeID:0
32772
88
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:86


0
0
1
0
333
444
1
RETURN "DC01"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/AdditionalAccountID:284/value:0
32770
89
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Party
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187
0
32770
90
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
8
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0
0
32770
91
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
25
$tmp = SEBTAC.GetPEPPOLSchemeID(TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))), @@);  ;MB[92] 
  ;MB[92] 
IF $tmp = "" {  ;MB[92] 
   DMU.Stop "Unkown country. Unable to resolve code to AccountingSupplierParty/Party/Endpoint";  ;MB[92] 
}  ;MB[92] 
  ;MB[92] 
/*  ;MB[92] 
IF STRLEN(@@) = 13 {  ;MB[92] 
   $tmp = "0088"; # Code for GLN/EAN  ;MB[92] 
}  ;MB[92] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {  ;MB[92] 
   $tmp = "0007";  ;MB[92] 
}  ;MB[92] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {  ;MB[92] 
   $tmp = "0192";  ;MB[92] 
}  ;MB[92] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {  ;MB[92] 
   $tmp = "0184";  ;MB[92] 
}  ;MB[92] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {  ;MB[92] 
   $tmp = "0037";  ;MB[92] 
}  ;MB[92] 
ELSE {  ;MB[92] 
   DMU.Stop "Unkown country. Unable to resolve code to AccountingSupplierParty/Party/Endpoint";  ;MB[92] 
}  ;MB[92] 

0
333
INH
EndpointID
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74
0
32772
92
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:91


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/schemeID:0
32772
93
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:91


0
0
1
0
333
444
1
RETURN SEBTAC.RemDash(@@)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/value:0
32770
94
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77
0
32770
95
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:94
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0
0
32770
96
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:94/INH:95
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4
0
32772
97
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:94/INH:95/INH:96


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Name:219
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4/value:0
32770
98
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PostalAddress
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79
0
32770
99
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
4
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0
0
32770
100
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
StreetName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85
0
32772
101
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99/INH:100


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Address1:729
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85/value:0
32770
102
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
CityName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96
0
32772
103
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99/INH:102


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_City:732
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96/value:0
32770
104
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PostalZone
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97
0
32772
105
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99/INH:104


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Zip_Code:731
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97/value:0
32770
106
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Country
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105
0
32770
107
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99/INH:106
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0
0
32770
108
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99/INH:106/INH:107
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
9
IF STRLEN(TRIMRIGHT(@@, " ")) > 1 {  ;MB[109] 
	$tmp = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@@)))));  ;MB[109] 
} ELSE {  ;MB[109] 
	$tmp = @@;  ;MB[109] 
}  ;MB[109] 
  ;MB[109] 
IF $tmp = "ZZ" {  ;MB[109] 
   $tmp = "NA";  ;MB[109] 
}  ;MB[109] 

0
333
INH
IdentificationCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106
0
32772
109
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:98/INH:99/INH:106/INH:107/INH:108


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Country:733
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106/value:0
32770
110
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1
1 = 2
333
333
444
1
# TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) <> "NO"  ;MB[110] 

0
333
INH
PartyTaxScheme_SWT
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122
0
32770
111
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0
0
32770
112
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110/INH:111
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124
0
32772
113
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110/INH:111/INH:112


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124/value:0
32770
114
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110/INH:111
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129
0
32770
115
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110/INH:111/INH:114
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
116
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110/INH:111/INH:114/INH:115
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
117
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:110/INH:111/INH:114/INH:115/INH:116


0
0
1
0
333
444
1
RETURN "SWT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
118
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyTaxScheme_VAT
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122
0
32770
119
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0
0
32770
120
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118/INH:119
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
17
$org_no = "";  ;MB[121] 
  ;MB[121] 
IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {  ;MB[121] 
   $org_no = "SE" & @Sender_Organisation_No & "01";  ;MB[121] 
}  ;MB[121] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {  ;MB[121] 
   $org_no = "NO" & @Sender_Organisation_No & "MVA";  ;MB[121] 
}  ;MB[121] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {  ;MB[121] 
   $org_no = "FI" & NYTTO.CLEANDIGITONLY(@Sender_Organisation_No);  ;MB[121] 
}  ;MB[121] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {  ;MB[121] 
   $org_no = @Sender_Organisation_No;  ;MB[121] 
}  ;MB[121] 
ELSE {  ;MB[121] 
   $org_no = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@@))))) & @Sender_Organisation_No;  ;MB[121] 
}  ;MB[121] 

0
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124
0
32772
121
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118/INH:119/INH:120


0
0
1
0
333
444
1
RETURN $org_no

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124/value:0
32770
122
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118/INH:119
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129
0
32770
123
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118/INH:119/INH:122
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
124
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118/INH:119/INH:122/INH:123
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
125
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:118/INH:119/INH:122/INH:123/INH:124


0
0
1
0
333
444
1
RETURN "VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
126
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyTaxScheme_TAX
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122
0
32770
127
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0
0
32770
128
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126/INH:127
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124
0
32772
129
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126/INH:127/INH:128


0
0
1
0
333
444
1
RETURN "Godkänd för F-skatt"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124/value:0
32770
130
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126/INH:127
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129
0
32770
131
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126/INH:127/INH:130
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
132
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126/INH:127/INH:130/INH:131
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
133
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:126/INH:127/INH:130/INH:131/INH:132


0
0
1
0
333
444
1
RETURN "TAX"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
134
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyLegalEntity
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133
0
32770
135
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:134
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0
0
32770
136
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:134/INH:135
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegName"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 {  ;MB[137] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegName"), $TAC[ ARRAYSIZE($TAC) ] );  ;MB[137] 
}  ;MB[137] 
ELSE {  ;MB[137] 
   $tmp = @@;  ;MB[137] 
}  ;MB[137] 

0
333
INH
RegistrationName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123
0
32772
137
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:134/INH:135/INH:136


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Name:219
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123/value:0
32770
138
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:134/INH:135
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegCompID"), $TAC[ ARRAYSIZE($TAC) ] )) > 0 {  ;MB[139] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierRegCompID"), $TAC[ ARRAYSIZE($TAC) ] );  ;MB[139] 
}  ;MB[139] 
ELSE {  ;MB[139] 
   $tmp = SEBTAC.RemDash(@@);  ;MB[139] 
}  ;MB[139] 

0
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124
0
32772
139
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:134/INH:135/INH:138


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Organisation_No:736
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124/value:0
32770
140
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Contact
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145
0
32770
141
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:140
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0
0
32770
142
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:140/INH:141
INH
SLN Based on INH
0
0
1
1
-1

333
444
1
DECLARE $Contact_name STRING;  ;MB[143] 

0
444
20
$Contact_name = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SupplierContactName"), $TAC[ 1 ] );  ;MB[143] 
  ;MB[143] 
IF $Contact_name = "" {  ;MB[143] 
   IF TRIMRIGHT(@Customer_Country, " ") <> "" {  ;MB[143] 
      IF STRLEN(TRIMRIGHT(@Customer_Country, " ")) > 2 {  ;MB[143] 
         IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Customer_Country))))) = "NO" {  ;MB[143] 
            $Contact_name = "Diners Club Norge  Corporate Support";  ;MB[143] 
         }  ;MB[143] 
         ELSE {  ;MB[143] 
            $Contact_name = @@;  ;MB[143] 
         }  ;MB[143] 
      }  ;MB[143] 
      ELSE {  ;MB[143] 
         $Contact_name = @@;  ;MB[143] 
      }  ;MB[143] 
   }  ;MB[143] 
   ELSE {  ;MB[143] 
      $Contact_name = @@;  ;MB[143] 
   }  ;MB[143] 
}  ;MB[143] 

0
333
INH
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4
0
32772
143
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:140/INH:141/INH:142


0
0
1
0
333
444
1
RETURN $Contact_name

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Sender_Name:219
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4/value:0
32770
144
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:140/INH:141
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
33
$tmp ="";  ;MB[145] 
  ;MB[145] 
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "SEBContactEmail"), $TAC[ 1 ] );  ;MB[145] 
  ;MB[145] 
IF $tmp = "" {  ;MB[145] 
  ;MB[145] 
   IF $InvoiceCountry = "SE" {  ;MB[145] 
      $tmp = "tacsupport@dinersclub.se ";  ;MB[145] 
   }  ;MB[145] 
   ELSE IF $InvoiceCountry = "NO" {  ;MB[145] 
      $tmp = "reisekonto@dinersclub.no";  ;MB[145] 
   }  ;MB[145] 
   ELSE IF $InvoiceCountry = "DK" {  ;MB[145] 
      $tmp = "rejsekonto@dinersclub.dk";  ;MB[145] 
   }  ;MB[145] 
   ELSE IF $InvoiceCountry = "FI" {  ;MB[145] 
      $tmp = "tacsupport@dinersclub.fi";  ;MB[145] 
   }  ;MB[145] 
   ELSE {  ;MB[145] 
      IF @Invoice_Currency_Code = "SEK" {  ;MB[145] 
         $tmp = "tacsupport@dinersclub.se ";  ;MB[145] 
      }  ;MB[145] 
      ELSE IF @Invoice_Currency_Code = "NOK" {  ;MB[145] 
         $tmp = "reisekonto@dinersclub.no";  ;MB[145] 
      }  ;MB[145] 
      ELSE IF @Invoice_Currency_Code = "DKK" {  ;MB[145] 
         $tmp = "rejsekonto@dinersclub.dk";  ;MB[145] 
      }  ;MB[145] 
      ELSE IF @Invoice_Currency_Code = "EUR" {  ;MB[145] 
         $tmp = "tacsupport@dinersclub.fi";  ;MB[145] 
      }  ;MB[145] 
   }  ;MB[145] 
}  ;MB[145] 

0
333
INH
ElectronicMail
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/ElectronicMail:148
0
32772
145
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:84/INH:85/INH:89/INH:90/INH:140/INH:141/INH:144


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingSupplierParty:282/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/ElectronicMail:148/value:0
32770
146
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
AccountingCustomerParty
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288
0
32770
147
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0
0
32770
148
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Party
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187
0
32770
149
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
7
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0
0
32770
150
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
54
$tmp = "";  ;MB[151] 
$endpoint = "";  ;MB[151] 
  ;MB[151] 
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNr"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {  ;MB[151] 
   $endpoint = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNr"), $TAC[ ARRAYSIZE($TAC)] );  ;MB[151] 
}  ;MB[151] 
ELSE {  ;MB[151] 
   $endpoint = SEBTAC.RemDash(@@);  ;MB[151] 
}  ;MB[151] 
  ;MB[151] 
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNrSchemeId"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {  ;MB[151] 
   $tmp =SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RecipientNrSchemeId"), $TAC[ ARRAYSIZE($TAC)] );  ;MB[151] 
}  ;MB[151] 
ELSE {  ;MB[151] 
   $tmp = SEBTAC.GetPEPPOLSchemeID($InvoiceCountry, $endpoint);  ;MB[151] 
}  ;MB[151] 
  ;MB[151] 
# If we didn't get a proper SchemeID, use the invoice issuing country as country in the lookup and assume domestic invocie  ;MB[151] 
IF $tmp = "" {  ;MB[151] 
   $tmp = SEBTAC.GetPEPPOLSchemeID(TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))), $endpoint);  ;MB[151] 
}  ;MB[151] 
  ;MB[151] 
/*  ;MB[151] 
IF STRLEN($endpoint) = 13 {  ;MB[151] 
   $tmp = "0088"; # Code for GLN/EAN  ;MB[151] 
}  ;MB[151] 
ELSE IF $InvoiceCountry = "SE" {  ;MB[151] 
   $tmp = "0007";  ;MB[151] 
}  ;MB[151] 
ELSE IF $InvoiceCountry = "NO" {  ;MB[151] 
   $tmp = "0192";  ;MB[151] 
}  ;MB[151] 
ELSE IF $InvoiceCountry = "DK" {  ;MB[151] 
   $tmp = "0092";  ;MB[151] 
}  ;MB[151] 
ELSE IF $InvoiceCountry = "FI" {  ;MB[151] 
   $tmp = "0037";  ;MB[151] 
}  ;MB[151] 
# Use the Diners coutry code for the customer if customer country is missing since the customer is most likely a domestic customer.  ;MB[151] 
ELSE {  ;MB[151] 
   IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {  ;MB[151] 
      $tmp = "0007";  ;MB[151] 
   }  ;MB[151] 
   ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {  ;MB[151] 
      $tmp = "0192";  ;MB[151] 
   }  ;MB[151] 
   ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {  ;MB[151] 
      $tmp = "0092";  ;MB[151] 
   }  ;MB[151] 
   ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {  ;MB[151] 
      $tmp = "0037";  ;MB[151] 
   }  ;MB[151] 
}  ;MB[151] 
*/  ;MB[151] 

0
333
INH
EndpointID
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74
0
32772
151
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:150


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/schemeID:0
32772
152
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:150


0
0
1
0
333
444
1
RETURN $endpoint

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/EndpointID:74/value:0
32770
153
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77
0
32770
154
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:153
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0
0
32770
155
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:153/INH:154
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
8
$tmp = "";  ;MB[156] 
  ;MB[156] 
IF TRIMLEFT(@Customer_Name, " ") > 0 {  ;MB[156] 
   $tmp = @Customer_Name;  ;MB[156] 
}  ;MB[156] 
ELSE {  ;MB[156] 
   $tmp = @Address_Line_1_Member_Name;  ;MB[156] 
}  ;MB[156] 

0
333
INH
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4
0
32772
156
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:153/INH:154/INH:155


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyName:77/SEQUENCE1:0/Name:4/value:0
32770
157
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PostalAddress
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79
0
32770
158
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
4
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0
0
32770
159
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
StreetName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85
0
32772
160
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158/INH:159


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Address1:738
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/StreetName:85/value:0
32770
161
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
CityName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96
0
32772
162
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158/INH:161


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_City:741
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/CityName:96/value:0
32770
163
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PostalZone
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97
0
32772
164
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158/INH:163


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Zip_Code:740
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/PostalZone:97/value:0
32770
165
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Country
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105
0
32770
166
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158/INH:165
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0
0
32770
167
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158/INH:165/INH:166
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
9
$tmp = "";  ;MB[168] 
  ;MB[168] 
# If country is missing for the customer, we assume it's a native invoice and use the Diners country instead  ;MB[168] 
IF TRIMRIGHT($InvoiceCountry, " ") = "ZZ" {  ;MB[168] 
   $tmp = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country)))));  ;MB[168] 
}  ;MB[168] 
ELSE {  ;MB[168] 
   $tmp = $InvoiceCountry;  ;MB[168] 
}  ;MB[168] 

0
333
INH
IdentificationCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106
0
32772
168
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:157/INH:158/INH:165/INH:166/INH:167


0
0
1
1
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Country:742
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PostalAddress:79/SEQUENCE1:0/Country:105/SEQUENCE1:0/IdentificationCode:106/value:0
32770
169
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1
TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) <> "NO" AND 1=2
333
333
333
333
INH
PartyTaxScheme_SWT
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122
0
32770
170
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0
0
32770
171
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169/INH:170
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
8
$tmp = "";  ;MB[172] 
  ;MB[172] 
IF STRLEN($endpoint) = "13" {  ;MB[172] 
   $tmp = SEBTAC.RemDash(@@);  ;MB[172] 
}  ;MB[172] 
ELSE {  ;MB[172] 
   $tmp = $endpoint;  ;MB[172] 
}  ;MB[172] 

0
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124
0
32772
172
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169/INH:170/INH:171


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124/value:0
32770
173
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169/INH:170
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129
0
32770
174
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169/INH:170/INH:173
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
175
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169/INH:170/INH:173/INH:174
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
176
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:169/INH:170/INH:173/INH:174/INH:175


0
0
1
0
333
444
1
RETURN "SWT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
177
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyTaxScheme_VAT
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122
0
32770
178
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0
0
32770
179
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177/INH:178
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
80
$org_no = "";  ;MB[180] 
  ;MB[180] 
IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerTaxCompanyId"), $TAC[1]) <> "" {  ;MB[180] 
   $org_no = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerTaxCompanyId"), $TAC[1]);  ;MB[180] 
}  ;MB[180] 
ELSE {  ;MB[180] 
   # If string length of endpoint (could be overridden by RecipientNr from string config) is 13, assume GLN and use org.nr  ;MB[180] 
   IF STRLEN($endpoint) = "13" {  ;MB[180] 
      IF $InvoiceCountry = "SE" {  ;MB[180] 
         $org_no = "SE" & SEBTAC.RemDash(@@) & "01";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF $InvoiceCountry = "NO" {  ;MB[180] 
         $org_no = "NO" & SEBTAC.RemDash(@@) & "MVA";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF $InvoiceCountry = "DK" {  ;MB[180] 
         $tmp = SEBTAC.RemDash(@@);  ;MB[180] 
         IF STRLEN($tmp) > 2 {  ;MB[180] 
            IF $tmp[1,2] <> "DK" {  ;MB[180] 
               $org_no = "DK" & SEBTAC.RemDash(@@);  ;MB[180] 
            }  ;MB[180] 
            ELSE {  ;MB[180] 
               $org_no = SEBTAC.RemDash(@@);  ;MB[180] 
            }  ;MB[180] 
         }  ;MB[180] 
      }  ;MB[180] 
      # If country is missing on the customer, try to use the issuing companys country (assuming it's a domestic invoice)  ;MB[180] 
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {  ;MB[180] 
         $org_no = "SE" & SEBTAC.RemDash(@@) & "01";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {  ;MB[180] 
         $org_no = "NO" & SEBTAC.RemDash(@@) & "MVA";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {  ;MB[180] 
         $tmp = SEBTAC.RemDash(@@);  ;MB[180] 
         IF STRLEN($tmp) > 2 {  ;MB[180] 
            IF $tmp[1,2] <> "DK" {  ;MB[180] 
               $org_no = "DK" & SEBTAC.RemDash(@@);  ;MB[180] 
            }  ;MB[180] 
            ELSE {  ;MB[180] 
               $org_no = SEBTAC.RemDash(@@);  ;MB[180] 
            }  ;MB[180] 
         }  ;MB[180] 
      }  ;MB[180] 
      ELSE {  ;MB[180] 
         $org_no = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Customer_Country))))) & SEBTAC.RemDash(@@);  ;MB[180] 
      }  ;MB[180] 
   }  ;MB[180] 
   ELSE {  ;MB[180] 
      IF $InvoiceCountry = "SE" {  ;MB[180] 
         $org_no = "SE" & SEBTAC.RemDash($endpoint) & "01";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF $InvoiceCountry = "NO" {  ;MB[180] 
         $org_no = "NO" & SEBTAC.RemDash($endpoint) & "MVA";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF $InvoiceCountry = "DK" {  ;MB[180] 
         $tmp = SEBTAC.RemDash(@@);  ;MB[180] 
         IF STRLEN($tmp) > 2 {  ;MB[180] 
            IF $tmp[1,2] <> "DK" {  ;MB[180] 
               $org_no = "DK" & SEBTAC.RemDash(@@);  ;MB[180] 
            }  ;MB[180] 
            ELSE {  ;MB[180] 
               $org_no = SEBTAC.RemDash(@@);  ;MB[180] 
            }  ;MB[180] 
         }  ;MB[180] 
      }  ;MB[180] 
      # If country is missing on the customer, try to use the issuing companys country (assuming it's a domestic invoice)  ;MB[180] 
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {  ;MB[180] 
         $org_no = "SE" & SEBTAC.RemDash($endpoint) & "01";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {  ;MB[180] 
         $org_no = "NO" & SEBTAC.RemDash($endpoint) & "MVA";  ;MB[180] 
      }  ;MB[180] 
      ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {  ;MB[180] 
         $org_no = SEBTAC.RemDash($endpoint);  ;MB[180] 
      }  ;MB[180] 
      ELSE {  ;MB[180] 
         $org_no = TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Customer_Country))))) & SEBTAC.RemDash($endpoint);  ;MB[180] 
      }  ;MB[180] 
   }  ;MB[180] 
}  ;MB[180] 

0
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124
0
32772
180
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177/INH:178/INH:179


0
0
1
0
333
444
1
RETURN $org_no

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/CompanyID:124/value:0
32770
181
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177/INH:178
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129
0
32770
182
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177/INH:178/INH:181
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
183
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177/INH:178/INH:181/INH:182
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
184
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:177/INH:178/INH:181/INH:182/INH:183


0
0
1
0
333
444
1
RETURN "VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyTaxScheme:122/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
185
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PartyLegalEntity
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133
0
32770
186
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:185
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0
0
32770
187
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:185/INH:186
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
8
$tmp = "";  ;MB[188] 
  ;MB[188] 
IF TRIMLEFT(@Customer_Name, " ") > 0 {  ;MB[188] 
   $tmp = @Customer_Name;  ;MB[188] 
}  ;MB[188] 
ELSE {  ;MB[188] 
   $tmp = @Address_Line_1_Member_Name;  ;MB[188] 
}  ;MB[188] 

0
333
INH
RegistrationName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123
0
32772
188
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:185/INH:186/INH:187


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/RegistrationName:123/value:0
32770
189
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:185/INH:186
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
26
$tmp = "";  ;MB[190] 
  ;MB[190] 
IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerLegalCompanyId"), $TAC[1]) <> "" {  ;MB[190] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "CustomerLegalCompanyId"), $TAC[1]);  ;MB[190] 
}  ;MB[190] 
ELSE {  ;MB[190] 
   IF STRLEN($endpoint) = "13" {  ;MB[190] 
      IF $InvoiceCountry = "DK" {  ;MB[190] 
         $tmp = SEBTAC.RemDash(@@);  ;MB[190] 
         IF STRLEN($tmp) > 2 {  ;MB[190] 
            IF $tmp[1,2] <> "DK" {  ;MB[190] 
               $tmp = "DK" & SEBTAC.RemDash(@@);  ;MB[190] 
            }  ;MB[190] 
            ELSE {  ;MB[190] 
               $tmp = SEBTAC.RemDash(@@);  ;MB[190] 
            }  ;MB[190] 
         }  ;MB[190] 
      }  ;MB[190] 
      ELSE {  ;MB[190] 
         $tmp = SEBTAC.RemDash(@@);  ;MB[190] 
      }  ;MB[190] 
   }  ;MB[190] 
   ELSE {  ;MB[190] 
      $tmp = $endpoint;  ;MB[190] 
   }  ;MB[190] 
}  ;MB[190] 

0
333
INH
CompanyID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124
0
32772
190
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:185/INH:186/INH:189


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Customer_Organization_No:749
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/PartyLegalEntity:133/SEQUENCE1:0/CompanyID:124/value:0
32770
191
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149
INH
SLN Based on INH
0
0
1
1
-1

333
444
2
#removed STRLEN(ParamFun.GetParamValue( $ConfArr, "ContactName")) > 0  ;MB[191] 
# /AD  ;MB[191] 

0
333
333
INH
Contact
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145
0
32770
192
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:191
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0
0
32770
193
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:191/INH:192
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
15
$tmp = "";  ;MB[194] 
  ;MB[194] 
$tmp = @Member_Id;  ;MB[194] 
  ;MB[194] 
IF TRIMRIGHT($tmp, " ") = "" {  ;MB[194] 
    $tmp = @/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Member_Id;  ;MB[194] 
}  ;MB[194] 
  ;MB[194] 
IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContactName"), $TAC[1]) <> "" {  ;MB[194] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ContactName"), $TAC[1]);  ;MB[194] 
}  ;MB[194] 
  ;MB[194] 
IF $tmp = "" {  ;MB[194] 
   $tmp = "NA";  ;MB[194] 
}  ;MB[194] 

0
333
INH
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4
0
32772
194
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:146/INH:147/INH:148/INH:149/INH:191/INH:192/INH:193


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/AccountingCustomerParty:288/SEQUENCE1:0/Party:187/SEQUENCE1:0/Contact:145/SEQUENCE1:0/Name:4/value:0
32770
195
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ActualDeliveryDate"), $TAC[ ARRAYSIZE($TAC)] )) > 0
333
333
333
333
INH
Delivery
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296
0
32770
196
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:195
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296/SEQUENCE1:0
0
32770
197
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:195/INH:196
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
6
IF SL_STRING.ToUpper(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "ActualDeliveryDate"), $TAC[ ARRAYSIZE($TAC)] )) = "INVOICEDATE" {  ;MB[198] 
   $tmp = DMU.DateConvert(@INVOICE_DATE, "%Y%m%d", "%Y-%m-%d");  ;MB[198] 
}  ;MB[198] 
ELSE {  ;MB[198] 
   $tmp = DMU.DateNow("%Y-%m-%d");  ;MB[198] 
}  ;MB[198] 

0
333
INH
ActualDeliveryDate
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296/SEQUENCE1:0/ActualDeliveryDate:300
0
32772
198
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:195/INH:196/INH:197


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/Delivery:296/SEQUENCE1:0/ActualDeliveryDate:300/value:0
32770
199
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "PayeeFinancialAccount") <> "NOACCOUNT"
333
333
333
333
INH
PaymentMeans
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231
0
32770
200
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0
0
32770
201
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PaymentMeansCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentMeansCode:232
0
32772
202
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:201


0
0
1
0
333
444
1
RETURN "30"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Diners_Club_Bank_Account_No:415
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentMeansCode:232/value:0
32770
203
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PaymentID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentID:237
0
32772
204
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:203


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/OCR_Ref:752
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentID:237/value:0
32770
205
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PayeeFinancialAccount
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250
0
32770
206
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0
0
32770
207
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
28
$tmp ="";  ;MB[208] 
  ;MB[208] 
IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "SE" {  ;MB[208] 
   $tmp = "BG";  ;MB[208] 
}  ;MB[208] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "NO" {  ;MB[208] 
   $tmp = "BBAN";  ;MB[208] 
}  ;MB[208] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "DK" {  ;MB[208] 
   $tmp = "???";  ;MB[208] 
}  ;MB[208] 
ELSE IF TRIMRIGHT(INFODATA.ISO_COUNTRY_FROM_NAME(SL_STRING.TOUPPER(TRIMLEFT(TRIMRIGHT(@Sender_Country))))) = "FI" {  ;MB[208] 
   $tmp = "???";  ;MB[208] 
}  ;MB[208] 
ELSE {  ;MB[208] 
   IF @Invoice_Currency_Code = "SEK" {  ;MB[208] 
      $tmp = "BG";  ;MB[208] 
   }  ;MB[208] 
   ELSE IF @Invoice_Currency_Code = "NOK" {  ;MB[208] 
      $tmp = "BBAN";  ;MB[208] 
   }  ;MB[208] 
   ELSE IF @Invoice_Currency_Code = "DKK" {  ;MB[208] 
      $tmp = "???";  ;MB[208] 
   }  ;MB[208] 
   ELSE IF @Invoice_Currency_Code = "EUR" {  ;MB[208] 
      $tmp = "???";  ;MB[208] 
   }  ;MB[208] 
}  ;MB[208] 

0
333
INH
ID
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3
0
32772
208
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206/INH:207


0
0
1
0
444
1
RETURN 1=2

0
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3/schemeID:0
32772
209
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206/INH:207


0
0
1
0
333
444
1
RETURN TrimLeft(@Diners_Club_Bank_Registration_No, "0") & TrimLeft(@@,"0")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Diners_Club_Bank_Account_No:415
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3/value:0
32770
210
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
FinancialInstitutionBranch
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171
0
32770
211
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206/INH:210
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0
0
32770
212
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206/INH:210/INH:211
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
18
$tmp = "";  ;MB[213] 
  ;MB[213] 
# If we have oveerride, use that  ;MB[213] 
IF STRLEN(ParamFun.GetParamValue( $ConfArr, "BIC")) > 0 {  ;MB[213] 
   $tmp = ParamFun.GetParamValue( $ConfArr, "BIC");  ;MB[213] 
}  ;MB[213] 
ELSE {  ;MB[213] 
   # If PayeeFinancialAccount configuration is made, use BIC from file  ;MB[213] 
   IF STRLEN(ParamFun.GetParamValue( $ConfArr, "PayeeFinancialAccount")) > 0 {  ;MB[213] 
      $tmp = @@;  ;MB[213] 
   }  ;MB[213] 
   ELSE IF @Invoice_Currency_Code = "SEK" {  ;MB[213] 
      $tmp = "SE:BANKGIRO"; # Swedish bankgiro   ;MB[213] 
   }  ;MB[213] 
   ELSE {  ;MB[213] 
      $tmp = @@;  ;MB[213] 
   }  ;MB[213] 
}  ;MB[213] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3
0
32772
213
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:199/INH:200/INH:205/INH:206/INH:210/INH:211/INH:212


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/SWIFT:990
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3/value:0
32770
214
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "IBAN") <> "NOIBAN"
333
333
333
333
INH
PaymentMeans_IBAN
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231
0
32770
215
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0
0
32770
216
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PaymentMeansCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentMeansCode:232
0
32772
217
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:216


0
0
1
0
444
1
RETURN STRLEN(TRIMLEFT($IBAN)) > 0

0
444
1
RETURN "30"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentMeansCode:232/value:0
32770
218
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PaymentID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentID:237
0
32772
219
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:218


0
0
1
0
444
1
RETURN STRLEN(TRIMLEFT($IBAN)) > 0

0
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/OCR_Ref:752
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PaymentID:237/value:0
32770
220
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
PayeeFinancialAccount
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250
0
32770
221
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0
0
32770
222
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3
0
32772
223
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221/INH:222


0
0
1
0
444
1
RETURN STRLEN(TRIMLEFT($IBAN)) > 0

0
444
1
RETURN $IBAN

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/IBAN:938
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/ID:3/value:0
32770
224
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/Name:4
0
32772
225
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221/INH:224


0
0
1
0
444
1
RETURN STRLEN(TRIMLEFT($IBAN)) > 0

0
444
1
RETURN "IBAN"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/Name:4/value:0
32770
226
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
FinancialInstitutionBranch
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171
0
32770
227
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221/INH:226
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0
0
32770
228
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221/INH:226/INH:227
INH
SLN Based on INH
0
0
1
1
-1

333
333
444
8
$tmp = "";  ;MB[229] 
  ;MB[229] 
IF STRLEN(ParamFun.GetParamValue( $ConfArr, "IBANBIC")) > 0 {  ;MB[229] 
   $tmp = ParamFun.GetParamValue( $ConfArr, "IBANBIC");  ;MB[229] 
}  ;MB[229] 
ELSE {  ;MB[229] 
   $tmp = @SWIFT;  ;MB[229] 
}  ;MB[229] 

0
333
INH
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3
0
32772
229
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:214/INH:215/INH:220/INH:221/INH:226/INH:227/INH:228


0
0
1
0
444
1
RETURN STRLEN(TRIMLEFT($IBAN)) > 0

0
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/SWIFT:990
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentMeans:231/SEQUENCE1:0/PayeeFinancialAccount:250/SEQUENCE1:0/FinancialInstitutionBranch:171/SEQUENCE1:0/ID:3/value:0
32770
230
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INH
SLN Based on INH
0
0
1
1
-1
$TAC[1].$OrigRecord <> "ADA" AND STRLEN(ParamFun.GetParamValue( $ConfArr, "PaymentTerms")) > 0
333
333
333
333
INH
PaymentTerms
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744
0
32770
231
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:230
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0
0
32770
232
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:230/INH:231
INH
SLN Based on INH
0
0
1
1
-1

333
333
333
333
INH
Note
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0/Note:23
0
32772
233
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INH:230/INH:231/INH:232


0
0
1
0
333
444
1
RETURN ParamFun.GetParamValue( $ConfArr, "PaymentTerms")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0/Note:23/value:0
32770
234
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
ADA_LOOP
SLN Based on ADA_LOOP
0
0
1
0
0
$TAC[1].$OrigRecord = "ADA"
333
333
333
333
ADA_LOOP
PaymentTerms_ADA
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744
0
32770
235
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:234
ADA
SLN Based on ADA
0
0
1
0
0

333
333
333
333
ADA
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0
0
32770
236
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:234/ADA:235
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
Note
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0/Note:23
0
32772
237
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:234/ADA:235/ADA:236


0
0
1
0
333
444
1
RETURN "Penalty Surcharge Percent: " & FORMAT("%.2f",(@@)/100) & "%" 

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Interest_Inv_Interest_Rate:996
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/PaymentTerms:744/SEQUENCE1:0/Note:23/value:0
32770
238
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INT
SLN Based on INT
0
0
1
0
0

333
333
333
333
INT
TaxTotal
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222
0
32770
239
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0
0
32770
240
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
TaxAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxAmount:223
0
32772
241
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:240


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxAmount:223/currencyID:0
32772
242
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:240


0
0
1
0
333
444
1
RETURN FORMAT("%.2f", $Sum_VAT_calculated)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxAmount:223/value:0
32770
243
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239
INT
SLN Based on INT
0
0
1
ARRAYSIZE($R_SUMVAT)
-1

333
444
1
$R_SUMVAT_COUNTER = 0;  ;MB[243] 

0
444
1
$R_SUMVAT_COUNTER = $R_SUMVAT_COUNTER + 1;  ;MB[243] 

0
333
INT
TaxSubtotal
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227
0
32770
244
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0
0
32770
245
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244
INT
SLN Based on INT
0
0
1
1
-1

333
333
444
10
$tmp = "";  ;MB[247] 
  ;MB[247] 
$tmp = $R_SUMVAT[$R_SUMVAT_COUNTER][2] ;  ;MB[247] 
  ;MB[247] 
IF $tmp = 0 {  ;MB[247] 
	$tmp = "0.00";  ;MB[247] 
}  ;MB[247] 
IF $tmp = "-0.00" {  ;MB[247] 
	$tmp = "0.00";  ;MB[247] 
}  ;MB[247] 

0
333
INT
TaxableAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxableAmount:228
0
32772
246
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:245


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxableAmount:228/currencyID:0
32772
247
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:245


0
0
1
0
333
444
1
RETURN FORMAT("%.2f", $tmp)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxableAmount:228/value:0
32770
248
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
TaxAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxAmount:223
0
32772
249
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:248


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxAmount:223/currencyID:0
32772
250
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:248


0
0
1
0
333
444
1
RETURN NYTTO.ROUNDOFF($R_SUMVAT[$R_SUMVAT_COUNTER][4], 2)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxAmount:223/value:0
32770
251
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
TaxCategory
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215
0
32770
252
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
SEQUENCE1
5
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0
0
32770
253
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252
INT
SLN Based on INT
0
0
1
1
-1

333
333
444
5
IF $R_SUMVAT[$R_SUMVAT_COUNTER][1] = 0 {  ;MB[254] 
	$tmp = "E";  ;MB[254] 
} ELSE {  ;MB[254] 
	$tmp = "S";  ;MB[254] 
}  ;MB[254] 

0
333
INT
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/ID:3
0
32772
254
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:253


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/ID:3/value:0
32770
255
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
Percent
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/Percent:216
0
32772
256
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:255


0
0
1
0
333
444
1
RETURN FORMAT("%.1f", $R_SUMVAT[$R_SUMVAT_COUNTER][1])

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/Percent:216/value:0
32770
257
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252
INT
SLN Based on INT
0
0
1
1
-1
$R_SUMVAT[$R_SUMVAT_COUNTER][1] = 0 AND $VATReason <> ""
333
333
333
333
INT
TaxExemptionReasonCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReasonCode:218
0
32772
258
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:257


0
0
1
0
444
1
RETURN 1=2

0
444
1
RETURN "Exempt from VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReasonCode:218/value:0
32770
259
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252
INT
SLN Based on INT
0
0
1
1
-1
$R_SUMVAT[$R_SUMVAT_COUNTER][1] = 0 AND $VATReason <> ""
333
333
333
333
INT
TaxExemptionReason
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReason:219
0
32772
260
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:259


0
0
1
0
333
444
1
RETURN $VATReason

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxExemptionReason:219/value:0
32770
261
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129
0
32770
262
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:261
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
263
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:261/INT:262
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
264
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:238/INT:239/INT:243/INT:244/INT:251/INT:252/INT:261/INT:262/INT:263


0
0
1
0
333
444
1
RETURN "VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/TaxTotal:222/SEQUENCE1:0/TaxSubtotal:227/SEQUENCE1:0/TaxCategory:215/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
265
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
INT
SLN Based on INT
0
0
1
0
0

333
333
333
333
INT
LegalMonetaryTotal
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827
0
32770
266
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
SEQUENCE1
5
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0
0
32770
267
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
LineExtensionAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/LineExtensionAmount:703
0
32772
268
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:267


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
32772
269
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:267


0
0
1
1
333
444
1
RETURN NYTTO.ROUNDOFF($Sum_NET, 2)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/LineExtensionAmount:703/value:0
32770
270
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266
INT
SLN Based on INT
0
0
1
1
-1

333
333
333
333
INT
TaxExclusiveAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxExclusiveAmount:828
0
32772
271
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:270


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxExclusiveAmount:828/currencyID:0
32772
272
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:270


0
0
1
1
333
444
1
RETURN NYTTO.ROUNDOFF($Sum_NET, 2)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxExclusiveAmount:828/value:0
32770
273
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266
INT
SLN Based on INT
0
0
1
1
-1

333
333
444
1
$tmp = $Sum_VAT_calculated + $Sum_NET;  ;MB[275] 

0
333
INT
TaxInclusiveAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxInclusiveAmount:829
0
32772
274
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:273


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxInclusiveAmount:829/currencyID:0
32772
275
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:273


0
0
1
1
333
444
1
RETURN NYTTO.ROUNDOFF($tmp, 2)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/TaxInclusiveAmount:829/value:0
32770
276
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266
INH
SLN Based on INH
0
0
1
1
-1

333
444
2
DECLARE $Total_amount FLOAT;  ;MB[278] 
DECLARE $Total_calc_amount FLOAT;  ;MB[278] 

0
444
5
$Total_amount = @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Sign_Mark_3 & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INT/Accumulated_Total_Detail;  ;MB[278] 
  ;MB[278] 
$Total_calc_amount = $Sum_NET + $Sum_VAT_calculated;  ;MB[278] 
  ;MB[278] 
$tmp = $Total_amount - $Total_calc_amount  ;MB[278] 

0
333
INH
PayableRoundingAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableRoundingAmount:833
0
32772
277
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INH:276


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Invoice_Currency_Code:774
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableRoundingAmount:833/currencyID:0
32772
278
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INH:276


0
0
1
0
333
444
1
RETURN FORMAT("%.2f", $tmp)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INH:2/Record_Type:3
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableRoundingAmount:833/value:0
32770
279
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266
INT
SLN Based on INT
0
0
1
1
-1

333
333
444
12
IF @Sign_Mark_3 = "-" {  ;MB[281] 
   $tmp = FORMAT("%.2f", (@Sign_Mark_3 & @Accumulated_Total_Detail));  ;MB[281] 
}   ;MB[281] 
ELSE {  ;MB[281] 
   $tmp = @Accumulated_Total_Detail;  ;MB[281] 
}  ;MB[281] 
IF $tmp = 0 {  ;MB[281] 
   $tmp = "0.00";  ;MB[281] 
}  ;MB[281] 
ELSE IF $tmp = "-0.00" {  ;MB[281] 
   $tmp = "0.00";  ;MB[281] 
}  ;MB[281] 

0
333
INT
PayableAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableAmount:834
0
32772
280
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:279


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Invoice_Currency:890
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableAmount:834/currencyID:0
32772
281
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/INT:265/INT:266/INT:279


0
0
1
1
333
444
1
RETURN NYTTO.ROUNDOFF($tmp, 2)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/INT:77/Record_Type:79
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/LegalMonetaryTotal:827/SEQUENCE1:0/PayableAmount:834/value:0
32770
282
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
TRA_LOOP
SLN Based on TRA_LOOP
0
0
0
0
0

333
333
333
333
TRA_LOOP
InvoiceLine
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
32770
283
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282
TAR_LOOP
SLN Based on TAR_LOOP
0
0
1
0
0

333
333
333
333
TAR_LOOP
InvoiceLine
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
32770
284
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283
TAR
SLN Based on TAR
0
0
1
0
0

333
333
444
3
$TARCount = $TARCount + 1;  ;MB[284] 
  ;MB[284] 
$tmp = ParamFun.GetParamValue( $ConfArr, "CreateSingleLineInvoice");  ;MB[284] 

0
333
TAR
SEQUENCE1
10
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0
0
32770
285
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
1
$Row_no = $Row_no + 1 ;  ;MB[286] 

0
333
TAR
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3
0
32772
286
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:285


0
0
1
0
333
444
1
RETURN  FORMAT("%.0f", $Row_no)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3/value:0
32770
287
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
444
23
DECLARE $trans_amt STRING;  ;MB[288] 
DECLARE $tmp_d_1 STRING;  ;MB[288] 
DECLARE $tmp_d_2 STRING;  ;MB[288] 
DECLARE $Code1 STRING;  ;MB[288] 
DECLARE $Code2 STRING;  ;MB[288] 
DECLARE $Code3 STRING;  ;MB[288] 
DECLARE $Code4 STRING;  ;MB[288] 
DECLARE $Code5 STRING;  ;MB[288] 
  ;MB[288] 
$Employee_Number = "";  ;MB[288] 
$departure_date = "";  ;MB[288] 
$return_date = "";  ;MB[288] 
$routing_code = "";  ;MB[288] 
$tmp = "";  ;MB[288] 
$note = "";  ;MB[288] 
$note2 = "";  ;MB[288] 
  ;MB[288] 
#Nullstille felt for hver "runde":  ;MB[288] 
$Code1 = "";  ;MB[288] 
$Code2 = "";  ;MB[288] 
$Code3 = "";  ;MB[288] 
$Code4 = "";  ;MB[288] 
$Code5 = "";  ;MB[288] 

0
444
44
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "LineNote"), $TAC[  $TARCount ]);  ;MB[288] 
  ;MB[288] 
IF $VATMode = "SFTI" {  ;MB[288] 
  $tmp = SEBTAC.GetLeadText("SE", "ROWVATERR") & TRIMLEFT((@Sign_Mark_2 & @VAT_Amount), "+") & " " & @/GRH_LOOP/MBH_LOOP/INH_LOOP/INH/Invoice_Currency_Code & "\r\n" & $tmp;   ;MB[288] 
	  ;MB[288] 
}  ;MB[288] 
  ;MB[288] 
# If not SFTI or LineNote from configuration string, set default value  ;MB[288] 
IF $tmp = "" {  ;MB[288] 
   $tmp = "Point of sale: " & @Establishment_Name & ", " & "Purchase: " & @Document_Description;  ;MB[288] 
}  ;MB[288] 
  ;MB[288] 
IF STRLEN(@Routing_Code_1) > 0 {  ;MB[288] 
   $Code1 = @Routing_Code_1 & ";";  ;MB[288] 
}  ;MB[288] 
IF STRLEN(@Routing_Code_1) > 3 {  ;MB[288] 
   $Code1 = STRMID(@Routing_Code_1, 1, 3) & ";";  ;MB[288] 
}  ;MB[288] 
IF STRLEN(@Routing_Code_2) > 0 {  ;MB[288] 
   $Code2 = @Routing_Code_2 & ";";  ;MB[288] 
}  ;MB[288] 
IF STRLEN(@Routing_Code_2) > 3 {  ;MB[288] 
   $Code2 = STRMID(@Routing_Code_2, 1, 3) & ";";  ;MB[288] 
}   ;MB[288] 
IF STRLEN(@Routing_Code_3) > 0 {  ;MB[288] 
   $Code3 = @Routing_Code_3 & ";";  ;MB[288] 
}  ;MB[288] 
IF STRLEN(@Routing_Code_3) > 3 {  ;MB[288] 
   $Code3 = STRMID(@Routing_Code_3, 1, 3) & ";";  ;MB[288] 
}   ;MB[288] 
IF STRLEN(@Routing_Code_4) > 0 {  ;MB[288] 
   $Code4 = @Routing_Code_4 & ";";  ;MB[288] 
}  ;MB[288] 
IF STRLEN(@Routing_Code_4) > 3 {  ;MB[288] 
   $Code4 = STRMID(@Routing_Code_4, 1, 3) & ";";  ;MB[288] 
}   ;MB[288] 
IF STRLEN(@Routing_Code_5) > 0 {  ;MB[288] 
   $Code5 = @Routing_Code_5 & ";";  ;MB[288] 
}  ;MB[288] 
IF STRLEN(@Routing_Code_5) > 3 {  ;MB[288] 
   $Code5 = STRMID(@Routing_Code_5, 1, 3) & ";";  ;MB[288] 
}  ;MB[288] 
  ;MB[288] 
$routing_code = $Code1 & $Code2 & $Code3 & $Code4 & $Code5;  ;MB[288] 

0
333
TAR
Note
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Note:23
0
32772
288
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:287


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Note:23/value:0
32770
289
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
9
$tmp = "";  ;MB[291] 
  ;MB[291] 
IF @Sign_Mark_3 = "-" {  ;MB[291] 
	$tmp = "-1";  ;MB[291] 
}  ;MB[291] 
  ;MB[291] 
ELSE {  ;MB[291] 
	$tmp = "1";  ;MB[291] 
}  ;MB[291] 

0
333
TAR
InvoicedQuantity
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702
0
32772
290
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:289


0
0
1
0
333
444
1
RETURN "EA"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/unitCode:0
32772
291
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:289


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/value:0
32770
292
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
12
IF $VATMode = "SFTI" {  ;MB[294] 
  $tmp = @Sign_Mark_3 & @Billing_Amount;  ;MB[294] 
}   ;MB[294] 
ELSE IF $VATMode = "GROSS" {  ;MB[294] 
   $tmp = FORMAT("%.2f", $TAC[$TARCount].$gross);  ;MB[294] 
}  ;MB[294] 
ELSE {  ;MB[294] 
   $tmp = $TAC[$TARCount].$Net;  ;MB[294] 
}  ;MB[294] 
IF @@ = 0 {  ;MB[294] 
	$tmp = "0.00";  ;MB[294] 
}  ;MB[294] 

0
333
TAR
LineExtensionAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703
0
32772
293
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:292


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Invoice_Currency:842
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
32772
294
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:292


0
0
1
1
333
444
1
RETURN FORMAT("%.2f", $tmp)

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Net_Amount:837
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/value:0
32770
295
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
5
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AccountingCostLine"), $TAC[  $TARCount ]);  ;MB[296] 
  ;MB[296] 
IF $tmp = "" {  ;MB[296] 
  $tmp = @Employee_No & "/" & @Customer_Cost_Centre & "/" & @Ordered_By & "/" & @Requisition_Order_No & "/" & @Project_No;  ;MB[296] 
}  ;MB[296] 

0
333
TAR
AccountingCost
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/AccountingCost:31
0
32772
296
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:295


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/AccountingCost:31/value:0
32770
297
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TRA
SLN Based on TRA
0
0
1
0
0
$CreateInvoicePDF = "1"
333
333
333
333
TRA
InvoicePeriod
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34
0
32770
298
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TRA:297
TRA
SLN Based on TRA
0
0
1
1
-1

333
333
333
333
TRA
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34/SEQUENCE1:0
0
32770
299
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TRA:297/TRA:298
TRA
SLN Based on TRA
0
0
1
1
-1

333
333
333
333
TRA
StartDate
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34/SEQUENCE1:0/StartDate:35
0
32772
300
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TRA:297/TRA:298/TRA:299


0
0
1
0
333
444
1
RETURN DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TRA:230/Transaction_Date:248
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicePeriod:34/SEQUENCE1:0/StartDate:35/value:0
32770
301
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderLineReference"), $TAC[  $TARCount ])) > 0
333
333
333
333
TAR
OrderLineReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646
0
32770
302
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:301
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646/SEQUENCE1:0
0
32770
303
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:301/TAR:302
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
LineID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646/SEQUENCE1:0/LineID:647
0
32772
304
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:301/TAR:302/TAR:303


0
0
1
0
333
444
1
RETURN SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "OrderLineReference"), $TAC[  $TARCount ])

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/OrderLineReference:646/SEQUENCE1:0/LineID:647/value:0
32770
305
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(@Transaction_Reference) > 0 OR STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLine"), $TAC[  $TARCount ])) > 0
333
333
333
333
TAR
DocumentReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46
0
32770
306
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:305
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0
0
32770
307
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:305/TAR:306
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
13
$tmp = "";  ;MB[308] 
  ;MB[308] 
IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineSchemeID"), $TAC[1]) <> "" {  ;MB[308] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineSchemeID"), $TAC[1]);  ;MB[308] 
}  ;MB[308] 
$tmp = @Transaction_Reference;  ;MB[309] 
  ;MB[309] 
IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLine"), $TAC[1]) <> "" {  ;MB[309] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLine"), $TAC[1]);  ;MB[309] 
}  ;MB[309] 
ELSE {  ;MB[309] 
	$tmp = @Transaction_Reference;  ;MB[309] 
}  ;MB[309] 

0
333
TAR
ID
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/ID:3
0
32772
308
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:305/TAR:306/TAR:307


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/ID:3/schemeID:0
32772
309
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:305/TAR:306/TAR:307


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/ID:3/value:0
32770
310
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:305/TAR:306
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
8
$tmp = "";  ;MB[311] 
  ;MB[311] 
IF SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineDocTypeCode"), $TAC[1]) <> "" {  ;MB[311] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "DocumentReferenceLineDocTypeCode"), $TAC[1]);  ;MB[311] 
}  ;MB[311] 
ELSE {  ;MB[311] 
	$tmp = "130";  ;MB[311] 
}  ;MB[311] 

0
333
TAR
DocumentTypeCode
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/DocumentTypeCode:47
0
32772
311
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:305/TAR:306/TAR:310


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/DocumentReference:46/SEQUENCE1:0/DocumentTypeCode:47/value:0
32770
312
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Item
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406
0
32770
313
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
28
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0
0
32770
314
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1

333
444
2
DECLARE $decimals INTEGER;  ;MB[315] 
DECLARE $trans_amt STRING;  ;MB[315] 

0
444
37
$tmp = "";  ;MB[315] 
$decimals = 0;  ;MB[315] 
$trans_amt = 0;  ;MB[315] 
  ;MB[315] 
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "LineDescription"), $TAC[  $TARCount ]);  ;MB[315] 
  ;MB[315] 
$Employee_Number = @Employee_No;  ;MB[315] 
IF (TRIMRIGHT($Employee_Number) = "") {  ;MB[315] 
   $Employee_Number = "NA";  ;MB[315] 
}  ;MB[315] 
  ;MB[315] 
$decimals = 0;  ;MB[315] 
$decimals = INFODATA.FETCH_MINORUNIT_FROM(@Currency_Code_ISO);  ;MB[315] 
  ;MB[315] 
IF $decimals = 0 {  ;MB[315] 
   $trans_amt = @Transaction_Amount;  ;MB[315] 
}   ;MB[315] 
ELSE IF $decimals = 1 {  ;MB[315] 
   $trans_amt = FORMAT("%.1f", @Transaction_Amount * 10);  ;MB[315] 
}   ;MB[315] 
ELSE IF $decimals = 2 {  ;MB[315] 
   $trans_amt = FORMAT("%.2f", @Transaction_Amount);  ;MB[315] 
}   ;MB[315] 
ELSE IF $decimals = 3 {  ;MB[315] 
   $trans_amt = FORMAT("%.3f", @Transaction_Amount / 10);  ;MB[315] 
}  ;MB[315] 
  ;MB[315] 
IF @Sign_mark_1 = "-" {  ;MB[315] 
   $trans_amt = "-" & $trans_amt;  ;MB[315] 
}  ;MB[315] 
  ;MB[315] 
IF $tmp = "" {  ;MB[315] 
   $tmp = "Name: " &  @Passenger_Name &   ;MB[315] 
       ", Amount: " & $trans_amt & ", CurrencyCode: " & @Currency_Code_ISO &   ;MB[315] 
       ", ExchangeRate: " & @Billing_Exchange_Rate & ", Transaction Reference: " & @Transaction_Reference &   ;MB[315] 
       ", EmployeeNumber: " & $Employee_Number;  ;MB[315] 
}  ;MB[315] 

0
333
TAR
Description
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Description:41
0
32772
315
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:314


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Product_Text:871
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Description:41/value:0
32770
316
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4
0
32772
317
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:316


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Product_Text:871
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4/value:0
32770
318
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "True" OR ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "Travel"
333
333
333
333
TAR
BuyersItemIdentification
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414
0
32770
319
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:318
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414/SEQUENCE1:0
0
32770
320
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:318/TAR:319
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
12
$tmp = "";  ;MB[321] 
  ;MB[321] 
IF ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "True" {  ;MB[321] 
   $tmp = SEBTAC.CustomerArticleID($SEBKort_PartnerAttribute.$PartnerKey & "_" & @@);  ;MB[321] 
}  ;MB[321] 
ELSE IF ParamFun.GetParamValue( $ConfArr, "ArticleNrBuyer") = "Travel" {  ;MB[321] 
   $tmp = SEBTAC.CustomerArticleID($SEBKort_PartnerAttribute.$PartnerKey & "_" & @Article_NumberAlfa);  ;MB[321] 
}  ;MB[321] 
  ;MB[321] 
IF $tmp = "" {  ;MB[321] 
   $tmp = TrimLeft(@@, "0");  ;MB[321] 
}  ;MB[321] 

0
333
TAR
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414/SEQUENCE1:0/ID:3
0
32772
321
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:318/TAR:319/TAR:320


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Article_Number:327
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/BuyersItemIdentification:414/SEQUENCE1:0/ID:3/value:0
32770
322
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SellersItemIdentification
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424
0
32770
323
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:322
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424/SEQUENCE1:0
0
32770
324
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:322/TAR:323
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
11
$tmp = "";  ;MB[325] 
  ;MB[325] 
IF ParamFun.GetParamValue( $ConfArr, "ArticleNrSeller") = "True" {  ;MB[325] 
	$tmp = @@;  ;MB[325] 
}   ;MB[325] 
ELSE IF ParamFun.GetParamValue( $ConfArr, "ArticleNrSeller") = "Travel" {  ;MB[325] 
	$tmp = @Article_NumberAlfa;  ;MB[325] 
}  ;MB[325] 
ELSE {  ;MB[325] 
	$tmp = @@;  ;MB[325] 
}  ;MB[325] 

0
333
TAR
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424/SEQUENCE1:0/ID:3
0
32772
325
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:322/TAR:323/TAR:324


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Article_Number:327
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/SellersItemIdentification:424/SEQUENCE1:0/ID:3/value:0
32770
326
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
ParamFun.GetParamValue( $ConfArr, "ArticleNrStandard") = "True"
333
333
333
333
TAR
StandardItemIdentification
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426
0
32770
327
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:326
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426/SEQUENCE1:0
0
32770
328
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:326/TAR:327
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426/SEQUENCE1:0/ID:3
0
32772
329
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:326/TAR:327/TAR:328


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Article_Number:327
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/StandardItemIdentification:426/SEQUENCE1:0/ID:3/value:0
32770
330
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
ClassifiedTaxCategory
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466
0
32770
331
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0
0
32770
332
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
11
$tmp = "";  ;MB[333] 
  ;MB[333] 
IF $TAC[$TARCount].$VATPercent = 0 {  ;MB[333] 
	$tmp = "E";  ;MB[333] 
}   ;MB[333] 
ELSE IF $VATMode = "GROSS" {  ;MB[333] 
   $tmp = "E";  ;MB[333] 
}  ;MB[333] 
ELSE {  ;MB[333] 
	$tmp = "S";  ;MB[333] 
}  ;MB[333] 

0
333
TAR
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3
0
32772
333
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331/TAR:332


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3/value:0
32770
334
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
11
$tmp = "";  ;MB[335] 
  ;MB[335] 
IF $VATMode = "EXACT1" {  ;MB[335] 
   $tmp = FORMAT("%.1f", $TAC[$TARCount].$VATPercent);  ;MB[335] 
}  ;MB[335] 
ELSE IF $VATMode = "NORMAL" OR $VATMode = "NORMALSPAN" OR $VATMode = "NORMALINT" {  ;MB[335] 
   $tmp = FORMAT("%.1f", $TAC[ $TARCount ].$VATPercent);  ;MB[335] 
}  ;MB[335] 
ELSE IF $VATMode = "GROSS" {  ;MB[335] 
   $tmp = 0;  ;MB[335] 
}  ;MB[335] 

0
333
TAR
Percent
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216
0
32772
335
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331/TAR:334


0
0
1
0
333
444
1
RETURN $tmp 

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/VAT_Percent:490
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216/value:0
32770
336
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129
0
32770
337
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331/TAR:336
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
338
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331/TAR:336/TAR:337
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
339
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:330/TAR:331/TAR:336/TAR:337/TAR:338


0
0
1
0
333
444
1
RETURN "VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
340
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_PassengerName
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
341
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:340
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
342
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:340/TAR:341
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[343] 
  ;MB[343] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PASSENGER_NAME", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[343] 
  ;MB[343] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[343] 
   $tmp = "Passenger name";  ;MB[343] 
}  ;MB[343] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
343
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:340/TAR:341/TAR:342


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Passenger_Name:874
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
344
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:340/TAR:341
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
345
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:340/TAR:341/TAR:344


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Passenger_Name:874
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
346
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_CustomerCostCenter
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
347
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:346
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
348
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:346/TAR:347
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[349] 
  ;MB[349] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_CUSTCOSTCTR", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[349] 
  ;MB[349] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[349] 
   $tmp = "Customer cost center";  ;MB[349] 
}  ;MB[349] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
349
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:346/TAR:347/TAR:348


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Customer_Cost_Centre:305
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
350
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:346/TAR:347
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
351
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:346/TAR:347/TAR:350


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Customer_Cost_Centre:305
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
352
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_ProjectNumber
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
353
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:352
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
354
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:352/TAR:353
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[355] 
  ;MB[355] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PROJNR", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[355] 
  ;MB[355] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[355] 
   $tmp = "Project number";  ;MB[355] 
}  ;MB[355] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
355
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:352/TAR:353/TAR:354


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Project_No:849
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
356
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:352/TAR:353
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
357
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:352/TAR:353/TAR:356


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Project_No:849
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
358
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_Department
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
359
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:358
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
360
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:358/TAR:359
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[361] 
  ;MB[361] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_DEP", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[361] 
  ;MB[361] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[361] 
   $tmp = "Department";  ;MB[361] 
}  ;MB[361] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
361
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:358/TAR:359/TAR:360


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_Department_Number:301
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
362
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:358/TAR:359
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
363
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:358/TAR:359/TAR:362


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_Department_Number:301
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
364
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_RequsitionOrderNumber
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
365
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:364
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
366
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:364/TAR:365
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[367] 
  ;MB[367] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_REQORDNR", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[367] 
  ;MB[367] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[367] 
   $tmp = "Requisition/Order number";  ;MB[367] 
}  ;MB[367] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
367
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:364/TAR:365/TAR:366


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Requisition_Order_No:870
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
368
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:364/TAR:365
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
369
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:364/TAR:365/TAR:368


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Requisition_Order_No:870
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
370
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_Employee_no
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
371
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:370
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
372
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:370/TAR:371
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[373] 
  ;MB[373] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_EMPLNR", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[373] 
  ;MB[373] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[373] 
   $tmp = "Employee number";  ;MB[373] 
}  ;MB[373] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
373
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:370/TAR:371/TAR:372


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_No:873
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
374
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:370/TAR:371
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
375
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:370/TAR:371/TAR:374


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Employee_No:873
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
376
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_ExternalReference
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
377
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:376
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
378
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:376/TAR:377
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[379] 
  ;MB[379] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_EXTREF", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[379] 
  ;MB[379] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[379] 
   $tmp = "External reference";  ;MB[379] 
}  ;MB[379] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
379
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:376/TAR:377/TAR:378


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/External_Reference:316
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
380
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:376/TAR:377
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
381
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:376/TAR:377/TAR:380


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/External_Reference:316
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
382
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_OrderedBy
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
383
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:382
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
384
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:382/TAR:383
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[385] 
  ;MB[385] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ORDERBY", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[385] 
  ;MB[385] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[385] 
   $tmp = "Ordered by";  ;MB[385] 
}  ;MB[385] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
385
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:382/TAR:383/TAR:384


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ordered_By:302
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
386
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:382/TAR:383
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
387
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:382/TAR:383/TAR:386


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ordered_By:302
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
388
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
@Departure_Date_1_4 > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_DepartureDate
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
389
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:388
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
390
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:388/TAR:389
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[391] 
  ;MB[391] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_DEPDATE", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[391] 
  ;MB[391] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[391] 
   $tmp = "Departure date";  ;MB[391] 
}  ;MB[391] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
391
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:388/TAR:389/TAR:390


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Departure_Date_1_4:850
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
392
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:388/TAR:389
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
6
IF STRLEN(@@) = 6 {  ;MB[393] 
   $tmp = DMU.DateConvert(@@, "%y%m%d", "%Y-%m-%d");  ;MB[393] 
}  ;MB[393] 
ELSE {  ;MB[393] 
   $tmp = DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d");  ;MB[393] 
}  ;MB[393] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
393
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:388/TAR:389/TAR:392


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Departure_Date_1_4:850
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
394
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
@Return_Date > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_ReturnDate
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
395
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:394
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
396
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:394/TAR:395
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[397] 
  ;MB[397] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_RETDATE", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[397] 
  ;MB[397] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[397] 
   $tmp = "Return date";  ;MB[397] 
}  ;MB[397] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
397
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:394/TAR:395/TAR:396


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Return_Date:308
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
398
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:394/TAR:395
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
399
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:394/TAR:395/TAR:398


0
0
1
0
333
444
1
RETURN  DMU.DateConvert(@@, "%Y%m%d", "%Y-%m-%d")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Return_Date:308
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
400
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
@Ticket_Number <> 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_TicketNumber
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
401
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:400
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
402
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:400/TAR:401
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[403] 
  ;MB[403] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_TICKET_NUMBER", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[403] 
  ;MB[403] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[403] 
   $tmp = "Ticket number";  ;MB[403] 
}  ;MB[403] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
403
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:400/TAR:401/TAR:402


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ticket_Number:307
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
404
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:400/TAR:401
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
405
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:400/TAR:401/TAR:404


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Ticket_Number:307
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
406
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(TRIMRIGHT(@/GRH_LOOP/MBH_LOOP/INH_LOOP/TRA_LOOP/TAR_LOOP/TAR/Routing_in_Text, " ")) > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_RoutingInText
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
407
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:406
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
408
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:406/TAR:407
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[409] 
  ;MB[409] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ROUTINTEXT", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[409] 
  ;MB[409] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[409] 
   $tmp = "Routing in text";  ;MB[409] 
}  ;MB[409] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
409
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:406/TAR:407/TAR:408


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Routing_in_Text:282
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
410
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:406/TAR:407
TAR
SLN Based on TAR
0
0
1
1
-1

333
444
1
# TRIMRIGHT($tmp, "-")  ;MB[411] 

0
444
2
#$tmp = "";  ;MB[411] 
#$tmp = @@ & "-" & @Routing_Text_2 & "-" & @Routing_Text_3 & "-" & @Routing_Text_4 & "-" & @Routing_Text_5;  ;MB[411] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
411
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:406/TAR:407/TAR:410


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Routing_in_Text:282
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
412
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(TRIMLEFT($routing_code, " ")) > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_RoutingCodes
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
413
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:412
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
414
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:412/TAR:413
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[415] 
  ;MB[415] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ROUTECODES", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[415] 
  ;MB[415] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[415] 
   $tmp = "Routing codes";  ;MB[415] 
}  ;MB[415] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
415
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:412/TAR:413/TAR:414


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
416
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:412/TAR:413
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
417
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:412/TAR:413/TAR:416


0
0
1
0
333
444
1
RETURN $routing_code

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
418
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(TRIMLEFT(@Routing_End_Destination, " ")) > 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "RoutingEndDest"), $TAC[  $TARCount ])) = "ON"
333
333
333
333
TAR
AdditionalItemProperty_RoutingEndDest
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
419
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:418
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
420
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:418/TAR:419
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[421] 
  ;MB[421] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_ROUTING_END_DEST", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[421] 
  ;MB[421] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[421] 
   $tmp = "Routing end destination";  ;MB[421] 
}  ;MB[421] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
421
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:418/TAR:419/TAR:420


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
422
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:418/TAR:419
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
423
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:418/TAR:419/TAR:422


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Routing_End_Destination:501
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
424
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_TurnAroundPoint
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
425
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:424
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
426
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:424/TAR:425
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[427] 
  ;MB[427] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_TURNPNT", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[427] 
  ;MB[427] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[427] 
   $tmp = "Turn around point";  ;MB[427] 
}  ;MB[427] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
427
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:424/TAR:425/TAR:426


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Turn_Around_Point:330
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
428
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:424/TAR:425
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
429
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:424/TAR:425/TAR:428


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Turn_Around_Point:330
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
430
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_Descriptive_Text
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
431
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:430
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
432
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:430/TAR:431
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[433] 
  ;MB[433] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_DESCTEXT", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[433] 
  ;MB[433] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[433] 
   $tmp = "Descriptive text";  ;MB[433] 
}  ;MB[433] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
433
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:430/TAR:431/TAR:432


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Descriptive_Text:876
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
434
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:430/TAR:431
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
435
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:430/TAR:431/TAR:434


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Descriptive_Text:876
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
436
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
$CreateVAT=1
333
333
333
333
TAR
AdditionalItemProperty_VAT
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
437
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:436
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
438
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:436/TAR:437
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[439] 
  ;MB[439] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_TRVLVAT", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[439] 
  ;MB[439] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[439] 
   $tmp = "Travel agency VAT";  ;MB[439] 
}  ;MB[439] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
439
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:436/TAR:437/TAR:438


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/VAT_Amount:29
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
440
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:436/TAR:437
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
3
$tmp = "";  ;MB[441] 
  ;MB[441] 
$tmp = @Sign_Mark_2 & @@;  ;MB[441] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
441
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:436/TAR:437/TAR:440


0
0
1
0
333
444
1
RETURN TRIMLEFT($tmp, "+")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/VAT_Amount:29
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
442
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
$VATMode = "GROSS" AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_Net_amount
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
443
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:442
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
444
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:442/TAR:443
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[445] 
  ;MB[445] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_NET", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[445] 
  ;MB[445] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[445] 
   $tmp = "Net amount";  ;MB[445] 
}  ;MB[445] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
445
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:442/TAR:443/TAR:444


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
446
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:442/TAR:443
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
1
$tmp = @Net_Amount_Sign_Mark & @Net_Amount;  ;MB[447] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
447
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:442/TAR:443/TAR:446


0
0
1
0
333
444
1
RETURN TRIMLEFT($tmp, "+")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
448
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
$CreateGross=1
333
333
333
333
TAR
AdditionalItemProperty_Gross_amount
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
449
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:448
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
450
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:448/TAR:449
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[451] 
  ;MB[451] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_GROSS", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[451] 
  ;MB[451] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[451] 
   $tmp = "Gross amount";  ;MB[451] 
}  ;MB[451] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
451
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:448/TAR:449/TAR:450


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
452
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(@../../TRA/Previous_Invoice_Delivery_Note_No) <> 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF" AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "PrevDeliveryNote"), $TAC[  $TARCount ])) = "ON"
333
333
333
333
TAR
AdditionalItemProperty_PrevDeliveryNote
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
453
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:452
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
454
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:452/TAR:453
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[455] 
  ;MB[455] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PREVDELNOTENO", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[455] 
  ;MB[455] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[455] 
   $tmp = "Previous delivery note no";  ;MB[455] 
}  ;MB[455] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
455
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:452/TAR:453/TAR:454


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
456
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:452/TAR:453
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
5
$tmp = @../../TRA/Previous_Invoice_Delivery_Note_No;  ;MB[457] 
  ;MB[457] 
IF STRLEN(@../../TRA/Previous_Invoice_Delivery_Note_No) = 0 {  ;MB[457] 
	$tmp = "NA";  ;MB[457] 
}  ;MB[457] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
457
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:452/TAR:453/TAR:456


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
458
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(@Original_Freja_Invoice_No) <> 0 AND SL_STRING.TOUPPER(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "MapAdditionalItemProperties"), $TAC[  $TARCount ])) <> "OFF"
333
333
333
333
TAR
AdditionalItemProperty_OriginalInvoiceNo
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
459
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:458
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
460
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:458/TAR:459
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[461] 
  ;MB[461] 
$tmp = SEBTAC.GetTextTranslation("ADDITIONALITEMPROPERTY_PREVINVNO", $InvoiceLanguage, $InvoiceLanguageDebug);  ;MB[461] 
  ;MB[461] 
IF TRIMLEFT($tmp, " ") = "" {  ;MB[461] 
   $tmp = "Original invoice number";  ;MB[461] 
}  ;MB[461] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
461
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:458/TAR:459/TAR:460


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
462
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:458/TAR:459
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
6
IF STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] )) > 0 {  ;MB[463] 
   $tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "InvoiceNrPrefix"), $TAC[ ARRAYSIZE($TAC)] ) & @Original_Freja_Invoice_No;  ;MB[463] 
}  ;MB[463] 
ELSE {  ;MB[463] 
   $tmp = @Original_Freja_Invoice_No;  ;MB[463] 
}  ;MB[463] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
463
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:458/TAR:459/TAR:462


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
464
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313
TAR
SLN Based on TAR
0
0
1
1
-1
STRLEN(SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalItemPropertyName1"), $TAC[  $TARCount ])) > 0 
333
333
333
333
TAR
AdditionalItemProperty_StringControlled
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467
0
32770
465
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:464
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0
0
32770
466
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:464/TAR:465
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
3
$tmp = "";  ;MB[467] 
  ;MB[467] 
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalItemPropertyName1"), $TAC[  $TARCount ]);  ;MB[467] 

0
333
TAR
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4
0
32772
467
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:464/TAR:465/TAR:466


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Name:4/value:0
32770
468
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:464/TAR:465
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
7
$tmp = "";  ;MB[469] 
  ;MB[469] 
$tmp = SEBTAC.GetTACValues( ParamFun.GetParamValue( $ConfArr, "AdditionalItemPropertyValue1"), $TAC[  $TARCount ]);  ;MB[469] 
  ;MB[469] 
IF $tmp = "" {  ;MB[469] 
   $tmp = "NA";  ;MB[469] 
}  ;MB[469] 

0
333
TAR
Value
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152
0
32772
469
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:312/TAR:313/TAR:464/TAR:465/TAR:468


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Record_Type:15
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/AdditionalItemProperty:467/SEQUENCE1:0/Value:152/value:0
32770
470
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
Price
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712
0
32770
471
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:470
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0
0
32770
472
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:470/TAR:471
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
444
12
IF $VATMode = "SFTI" {  ;MB[474] 
  $tmp = @Billing_Amount;  ;MB[474] 
}   ;MB[474] 
ELSE IF $VATMode = "GROSS" {  ;MB[474] 
   $tmp = FORMAT("%.2f", $TAC[$TARCount].$gross);  ;MB[474] 
}  ;MB[474] 
ELSE {  ;MB[474] 
   $tmp = $TAC[$TARCount].$Net;  ;MB[474] 
}  ;MB[474] 
IF @@ = 0 {  ;MB[474] 
	$tmp = "0.00";  ;MB[474] 
}  ;MB[474] 

0
333
TAR
PriceAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
32772
473
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:470/TAR:471/TAR:472


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Currency_Code_ISO:26
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/currencyID:0
32772
474
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:470/TAR:471/TAR:472


0
0
1
1
333
444
1
RETURN TRIMLEFT(FORMAT("%.2f", $tmp), "-")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Net_Amount:837
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/value:0
32770
475
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:470/TAR:471
TAR
SLN Based on TAR
0
0
1
1
-1

333
333
333
333
TAR
BaseQuantity
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714
0
32772
476
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/TRA_LOOP:282/TAR_LOOP:283/TAR:284/TAR:470/TAR:471/TAR:475


0
0
1
0
333
444
1
RETURN "1"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/TRA_LOOP:229/TAR_LOOP:12/TAR:13/Net_Amount:837
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714/value:0
32770
477
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
ADA_LOOP
SLN Based on ADA_LOOP
0
0
1
0
0
$AdjInvType <> "I"
333
333
333
333
ADA_LOOP
InvoiceLine_Adjustments
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
32770
478
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477
ADA
SLN Based on ADA
0
0
1
0
0

333
333
333
333
ADA
SEQUENCE1
5
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0
0
32770
479
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
444
1
$ADDCount = $ADDCount + 1;  ;MB[480] 

0
333
ADA
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3
0
32772
480
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:479


0
0
1
0
333
444
1
RETURN $ADDCount

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3/value:0
32770
481
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
444
6
IF @Sign_Mark_3 = "-"  ;MB[483] 
  ;MB[483] 
{    $tmp = "-1"; }  ;MB[483] 
ELSE  ;MB[483] 
  ;MB[483] 
{    $tmp = "1"; }  ;MB[483] 

0
333
ADA
InvoicedQuantity
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702
0
32772
482
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:481


0
0
1
0
333
444
1
RETURN "EA"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/unitCode:0
32772
483
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:481


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/value:0
32770
484
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
444
6
IF @Billing_Amount = 0 OR @Billing_Amount = "" {  ;MB[486] 
   $tmp = "0.00";  ;MB[486] 
}  ;MB[486] 
ELSE {  ;MB[486] 
   $tmp = @Sign_Mark_3 &  @Billing_Amount;  ;MB[486] 
}  ;MB[486] 

0
333
ADA
LineExtensionAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703
0
32772
485
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:484


0
0
1
0
444
1
RETURN $AdjInvType <> "I"

0
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
32772
486
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:484


0
0
1
1
333
444
1
RETURN TRIMLEFT($tmp, "+")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/value:0
32770
487
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
Item
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406
0
32770
488
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0
0
32770
489
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488
ADA
SLN Based on ADA
0
0
1
1
-1

333
444
2
DECLARE $article_name[] STRING;  ;MB[490] 
DECLARE $empty_s_1[] CONSTANT STRING;  ;MB[490] 

0
444
26
$article_name = $empty_s_1;  ;MB[490] 
$tmp = "";  ;MB[490] 
  ;MB[490] 
$article_name = SL_STRING.FieldExplode(@@, " ");  ;MB[490] 
  ;MB[490] 
# If there are spaces in the data, assume first value is MASKINELT and try to remove it  ;MB[490] 
IF ARRAYSIZE($article_name) > 1 {  ;MB[490] 
   FOR $i = 1 TO ARRAYSIZE($article_name) {  ;MB[490] 
      # Skip the first 3 values as they are not needed (e.g. DIV POST MEMBER ÅRSPRIS)  ;MB[490] 
      IF $i > 3 {  ;MB[490] 
         $tmp = $tmp & $article_name[$i] & " ";  ;MB[490] 
      }   ;MB[490] 
   }  ;MB[490] 
   IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type <> "R" {  ;MB[490] 
      IF STRLEN(TRIMLEFT(@Transaction_Reference)) > 0 {  ;MB[490] 
         $tmp = $tmp & " - " & @Transaction_Reference;  ;MB[490] 
      }  ;MB[490] 
   }  ;MB[490] 
}  ;MB[490] 
ELSE {  ;MB[490] 
   $tmp = @@;  ;MB[490] 
}  ;MB[490] 
  ;MB[490] 
IF $tmp = "" {  ;MB[490] 
   $tmp = @@;  ;MB[490] 
}  ;MB[490] 

0
333
ADA
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4
0
32772
490
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:489


0
0
1
0
333
444
1
RETURN TRIMRIGHT($tmp, " ")

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Transaction_Text:340
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4/value:0
32770
491
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
ClassifiedTaxCategory
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466
0
32770
492
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0
0
32770
493
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3
0
32772
494
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492/ADA:493


0
0
1
0
444
1
RETURN $AdjInvType <> "I"

0
444
1
RETURN "E"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3/value:0
32770
495
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
Percent
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216
0
32772
496
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492/ADA:495


0
0
1
0
444
1
RETURN $AdjInvType <> "I"

0
444
1
RETURN "0"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216/value:0
32770
497
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129
0
32770
498
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492/ADA:497
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
499
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492/ADA:497/ADA:498
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
500
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:487/ADA:488/ADA:491/ADA:492/ADA:497/ADA:498/ADA:499


0
0
1
0
444
1
RETURN $AdjInvType <> "I"

0
444
1
RETURN "VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
501
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
Price
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712
0
32770
502
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:501
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0
0
32770
503
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:501/ADA:502
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
444
6
IF @Billing_Amount = 0 {  ;MB[505] 
   $tmp = "0.00";  ;MB[505] 
}  ;MB[505] 
ELSE  {  ;MB[505] 
   $tmp = @Billing_Amount;  ;MB[505] 
}  ;MB[505] 

0
333
ADA
PriceAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
32772
504
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:501/ADA:502/ADA:503


0
0
1
0
444
1
RETURN $AdjInvType <> "I"

0
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/currencyID:0
32772
505
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:501/ADA:502/ADA:503


0
0
1
0
444
1
RETURN $AdjInvType <> "I"

0
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/value:0
32770
506
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:501/ADA:502
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
BaseQuantity
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714
0
32772
507
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:477/ADA:478/ADA:501/ADA:502/ADA:506


0
0
1
0
333
444
1
RETURN "1"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Record_Type:56
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/BaseQuantity:714/value:0
32770
508
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6
ADA_LOOP
SLN Based on ADA_LOOP
0
0
0
0
0

333
333
333
333
ADA_LOOP
InvoiceLine_ADD
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
32770
509
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508
ADD_LOOP
SLN Based on ADD_LOOP
0
0
1
0
0

333
333
444
1
$ADDCount = $ADDCount + 1;  ;MB[509] 

0
333
ADD_LOOP
InvoiceLine_ADD
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701
0
32770
510
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509
ADD
SLN Based on ADD
0
0
1
0
0

333
333
333
333
ADD
SEQUENCE1
6
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0
0
32770
511
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3
0
32772
512
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:511


0
0
1
0
333
444
1
RETURN $ADDCount

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/ID:3/value:0
32770
513
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
444
24
$tmp = "";  ;MB[514] 
IF @Orig_Invoice_Number <> "" {  ;MB[514] 
	$tmp = "Ursprungligt faktura nummer: " & TRIMLEFT(@Orig_Invoice_Number, "0") & ", ";  ;MB[514] 
}  ;MB[514] 
IF @Orig_Invoice_Date <> "" {  ;MB[514] 
	$tmp = $tmp & "Ursprungligt faktura datum: " & DMU.DateConvert( @Orig_Invoice_Date, "%Y%m%d", "%Y-%m-%d") & ", ";  ;MB[514] 
}  ;MB[514] 
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Interest_Inv_Interest_Rate <> "" {  ;MB[514] 
	$tmp = $tmp & "Straffränta: " & FORMAT("%.2f",(@/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Interest_Inv_Interest_Rate)/100) & " %, ";  ;MB[514] 
}  ;MB[514] 
IF @Interest_Calc_Base_Amount <> "" {  ;MB[514] 
	$tmp = $tmp & "Ränteberäknings belopp: " & @Interest_Calc_Base_Amount & ", ";  ;MB[514] 
}  ;MB[514] 
IF @Interest_Calc_To_Date <> "" AND @Interest_Calc_To_Date <> "00000000" {  ;MB[514] 
	$tmp = $tmp & "Betaldatum: " & DMU.DateConvert( @Interest_Calc_To_Date, "%Y%m%d", "%Y-%m-%d") &  ",";  ;MB[514] 
}  ;MB[514] 
IF @Orig_Invoice_Amount <> "" {  ;MB[514] 
	$tmp = $tmp & "Ursprungligt faktura belopp: " & @Orig_Invoice_Amount & ", ";  ;MB[514] 
}  ;MB[514] 
IF @Orig_Invoice_Due_Date <> "" {  ;MB[514] 
	$tmp = $tmp & "Ursprungligt förfallodatum: " & DMU.DateConvert( @Orig_Invoice_Due_Date, "%Y%m%d", "%Y-%m-%d") & ", ";  ;MB[514] 
}  ;MB[514] 
  ;MB[514] 
$tmp = TRIMRIGHT($tmp, ", ");  ;MB[514] 

0
333
ADD
Note
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Note:23
0
32772
514
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:513


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Note:23/value:0
32770
515
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
InvoicedQuantity
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702
0
32772
516
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:515


0
0
1
0
333
444
1
RETURN "EA"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/unitCode:0
32772
517
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:515


0
0
1
0
333
444
1
RETURN "1"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/InvoicedQuantity:702/value:0
32770
518
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
444
7
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "I"   ;MB[519] 
AND @Interest_Amount_Calc > 0  {  ;MB[519] 
	$tmp = @Interest_Amount_Calc;  ;MB[519] 
}   ;MB[519] 
ELSE {  ;MB[519] 
	$tmp = "0.00";  ;MB[519] 
}  ;MB[519] 

0
333
ADD
LineExtensionAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703
0
32772
519
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:518


0
0
1
1
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/value:0
32770
520
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:518
ADA
SLN Based on ADA
0
0
0
0
0

333
333
333
333
ADA
LineExtensionAmount
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703
0
32772
521
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:518/ADA:520


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/LineExtensionAmount:703/currencyID:0
32770
522
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510
ADA
SLN Based on ADA
0
0
1
0
0

333
333
333
333
ADA
Item
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406
0
32770
523
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
333
333
ADA
SEQUENCE1
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0
0
32770
524
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523
ADA
SLN Based on ADA
0
0
1
1
-1

333
333
444
13
$tmp = "-";  ;MB[525] 
  ;MB[525] 
/*  ;MB[525] 
$tmp = @@;  ;MB[525] 
  ;MB[525] 
IF STRLEN($tmp) > 17 {  ;MB[525] 
	$tmp = $tmp[17, STRLEN($tmp)];  ;MB[525] 
}  ;MB[525] 
  ;MB[525] 
IF $AdjInvType = "R" {  ;MB[525] 
   $tmp = "Original invoice information";  ;MB[525] 
}  ;MB[525] 
*/  ;MB[525] 

0
333
ADA
Name
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4
0
32772
525
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADA:524


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Transaction_Text:340
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/Name:4/value:0
32770
526
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
ClassifiedTaxCategory
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466
0
32770
527
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
SEQUENCE1
3
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0
0
32770
528
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3
0
32772
529
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527/ADD:528


0
0
1
0
333
444
1
RETURN "E"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/ID:3/value:0
32770
530
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
Percent
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216
0
32772
531
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527/ADD:530


0
0
1
0
333
444
1
RETURN "0"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/Percent:216/value:0
32770
532
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
TaxScheme
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129
0
32770
533
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527/ADD:532
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0
0
32770
534
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527/ADD:532/ADD:533
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
ID
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3
0
32772
535
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADA:522/ADA:523/ADD:526/ADD:527/ADD:532/ADD:533/ADD:534


0
0
1
0
333
444
1
RETURN "VAT"

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Item:406/SEQUENCE1:0/ClassifiedTaxCategory:466/SEQUENCE1:0/TaxScheme:129/SEQUENCE1:0/ID:3/value:0
32770
536
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
Price
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712
0
32770
537
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:536
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
333
333
ADD
SEQUENCE1
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0
0
32770
538
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:536/ADD:537
ADD
SLN Based on ADD
0
0
1
1
-1

333
333
444
7
IF @/GRH_LOOP/MBH_LOOP/INH_LOOP/ADA_LOOP/ADA/Adjustment_Inv_Type = "I"   ;MB[539] 
AND @Interest_Amount_Calc > 0 {  ;MB[539] 
	$tmp = @Interest_Amount_Calc;  ;MB[539] 
}   ;MB[539] 
ELSE {  ;MB[539] 
	$tmp = "0.00";  ;MB[539] 
}  ;MB[539] 

0
333
ADD
PriceAmount
2
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
32772
539
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:536/ADD:537/ADD:538


0
0
1
0
333
444
1
RETURN $tmp

0
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADD_LOOP:982/ADD:983/Record_Type:984
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/value:0
32770
540
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:536/ADD:537/ADD:538
ADA
SLN Based on ADA
0
0
0
0
0

333
333
333
333
ADA
PriceAmount
1
0
18
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54
18
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713
0
32772
541
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:15/GRH_LOOP:1/MBH_LOOP:2/INH_LOOP:3/INH:5/INH:6/ADA_LOOP:508/ADD_LOOP:509/ADD:510/ADD:536/ADD:537/ADD:538/ADA:540


0
0
1
0
333
333
20
/Freja invoice:429/GRH_LOOP:701/MBH_LOOP:699/INH_LOOP:694/ADA_LOOP:399/ADA:54/Currency_Code_ISO:63
20
/FRE_STD3_2_PEPPOL_BIS_Billing3.0_FI:0/UBLInvoice:0/Invoice:0/SEQUENCE1:0/InvoiceLine:701/SEQUENCE1:0/Price:712/SEQUENCE1:0/PriceAmount:713/currencyID:0
$RTIME:END
